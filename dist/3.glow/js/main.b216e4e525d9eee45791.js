!function(e){var r={};function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var o in e)t.d(n,o,function(r){return e[r]}.bind(null,o));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=34)}([function(e,r,t){"use strict";t.d(r,"e",(function(){return n})),t.d(r,"g",(function(){return l})),t.d(r,"h",(function(){return c})),t.d(r,"b",(function(){return v})),t.d(r,"c",(function(){return s})),t.d(r,"a",(function(){return i})),t.d(r,"d",(function(){return a})),t.d(r,"f",(function(){return f}));var n=function(e,r,t){var n=o(e,e.VERTEX_SHADER,r),i=o(e,e.FRAGMENT_SHADER,t),a=e.createProgram();return e.attachShader(a,n),e.attachShader(a,i),e.linkProgram(a),e.getProgramParameter(a,e.LINK_STATUS)?a:(alert("無法初始化著色器程序: "+e.getProgramInfoLog(a)),null)},o=function(e,r,t){var n=e.createShader(r);return e.shaderSource(n,t),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)?n:(alert("編譯著色器時發生錯誤: "+e.getShaderInfoLog(n)),e.deleteShader(n),null)},i=function(e,r,t){var n,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.STATIC_DRAW,i=e.createBuffer(),a=0,u={buffer:i,get data(){return n},get length(){return n.length},set:function(r){n=new Float32Array(r),a=100*Math.ceil(n.length/t/100),e.bindBuffer(e.ARRAY_BUFFER,i),e.bufferData(e.ARRAY_BUFFER,a*t*4,o),e.bufferSubData(e.ARRAY_BUFFER,0,n)},add:function(r){var u=n.length,f=100*Math.floor(n.length/t/100);f>=a&&(a=f+100,e.bindBuffer(e.ARRAY_BUFFER,i),e.bufferData(e.ARRAY_BUFFER,a*t*4,o),e.bufferSubData(e.ARRAY_BUFFER,0,n));var l=new Float32Array(u+t);l.set(n),n=l,this.item(u/t,r)},item:function(r,o){var a=new Float32Array(o);n.set(a,r*t),e.bindBuffer(e.ARRAY_BUFFER,i),e.bufferSubData(e.ARRAY_BUFFER,r*t*4,a)},getItem:function(e){return Array.from(n.slice(e*t,(e+1)*t))}};return u.set(r),u},a=function(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.STATIC_DRAW,n=new Uint8Array(r),o=e.createBuffer();e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,o),e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,t);var i={buffer:o,get data(){return n},get length(){return n.length}};return i},u=function(e){var r=e.createTexture();return e.bindTexture(e.TEXTURE_2D,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),r},f=function(e,r){var t=u(e),n=new Image;return n.onload=function(){e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)},n.src=r,t},l=function(e,r,t,n){e.bindFramebuffer(e.FRAMEBUFFER,r),e.viewport(0,0,t,n)},c=function(e,r){l(e,r.framebuffer,r.width,r.height)},v=function(e,r,t){var n={width:r||e.canvas.clientWidth,height:t||e.canvas.clientHeight},o=u(e);n.texture=o,e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,null);var i=e.createFramebuffer();return n.framebuffer=i,e.bindFramebuffer(e.FRAMEBUFFER,i),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,o,0),e.bindFramebuffer(e.FRAMEBUFFER,null),n},s=function(e,r,t,n){for(var o=[],i=0;i<r;i++)o.push(v(e,t,n));return e.bindFramebuffer(e.FRAMEBUFFER,null),o}},function(e,r){e.exports=function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}},function(e,r){function t(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}},function(e,r,t){"use strict";t.d(r,"a",(function(){return f})),t.d(r,"b",(function(){return l}));var n=t(1),o=t.n(n),i=t(2),a=t.n(i),u=t(4),f=function(){function e(){o()(this,e)}return a()(e,null,[{key:"toPosRate",value:function(e,r,t){return[e[0]*(1-t)+r[0]*t,e[1]*(1-t)+r[1]*t]}},{key:"cross",value:function(e,r,t){return(e[0]-r[0])*(t[1]-r[1])-(t[0]-r[0])*(e[1]-r[1])}},{key:"getCenter",value:function(e,r){return[.5*(e[0]+r[0]),.5*(e[1]+r[1])]}},{key:"getVector",value:function(e,r){return[r[0]-e[0],r[1]-e[1]]}},{key:"addVector",value:function(e,r){return[e[0]+r[0],e[1]+r[1]]}},{key:"distance",value:function(r,t){return u.a.length(e.getVector(r,t))}},{key:"getLine",value:function(r,t){return{point:r,vector:e.getVector(r,t)}}}]),e}(),l=function(){function e(){o()(this,e)}return a()(e,null,[{key:"set",value:function(e,r,t){return e[0]=r,e[1]=t,e}},{key:"addVector",value:function(e,r){return e[0]+=r[0],e[1]+=r[1],e}}]),e}()},function(e,r,t){"use strict";t.d(r,"a",(function(){return u})),t.d(r,"b",(function(){return f}));var n=t(1),o=t.n(n),i=t(2),a=t.n(i),u=function(){function e(){o()(this,e)}return a()(e,null,[{key:"normalize",value:function(r){return e.length(r)?e.scale(r,1/e.length(r)):r}},{key:"rotate",value:function(e,r){var t=Math.cos(r),n=Math.sin(r);return[e[0]*t-e[1]*n,e[1]*t+e[0]*n]}},{key:"dot",value:function(e,r){return e[0]*r[0]+e[1]*r[1]}},{key:"cross",value:function(e,r){return e[0]*r[1]-e[1]*r[0]}},{key:"add",value:function(e,r){return[e[0]+r[0],e[1]+r[1]]}},{key:"sub",value:function(e,r){return[e[0]-r[0],e[1]-r[1]]}},{key:"projection",value:function(r,t){var n=e.dot(r,t)/e.dot(t,t);return[t[0]*n,t[1]*n]}},{key:"length",value:function(r){return Math.sqrt(e.dot(r,r))}},{key:"scale",value:function(e,r){return[e[0]*r,e[1]*r]}},{key:"collisionCalc",value:function(r,t,n,o){return e.scale(e.add(e.scale(r,n-o),e.scale(t,2*o)),1/(n+o))}},{key:"getAngle",value:function(e){return Math.atan2(e[1],e[0])}}]),e}(),f=function(){function e(){o()(this,e)}return a()(e,null,[{key:"set",value:function(e,r,t){return e[0]=r,e[1]=t,e}},{key:"normalize",value:function(r){var t=u.length(r);return t&&e.scale(r,1/t),r}},{key:"add",value:function(e,r){return e[0]+=r[0],e[1]+=r[1],e}},{key:"sub",value:function(e,r){return e[0]-=r[0],e[1]-=r[1],e}},{key:"scale",value:function(e,r){return e[0]*=r,e[1]*=r,e}},{key:"rotate",value:function(e,r){var t=Math.cos(r),n=Math.sin(r),o=[e[0]*t-e[1]*n,e[1]*t+e[0]*n];return e[0]=o[0],e[1]=o[1],e}}]),e}()},,function(e,r){e.exports="attribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\nvarying highp vec2 vTextureCoord;\r\nuniform float uFlipY;\r\nvoid main(void){\r\n  vTextureCoord=aTextureCoord;\r\n  gl_Position=vec4((2.*aVertexPosition+vec2(-1.,-1.))*vec2(1.,uFlipY),0.,1.);\r\n}"},function(e,r){e.exports="precision mediump float;\r\nvarying vec2 vTextureCoord;\r\nuniform sampler2D uSampler;\r\nuniform lowp vec2 uSize;\r\n\r\n// 3x3\r\nvec4 blur5(sampler2D image,vec2 uv,vec2 resolution,vec2 direction){\r\n  vec4 color=vec4(0.);\r\n  vec2 off1=vec2(1.3333333333333333)*direction;\r\n  color+=texture2D(image,uv)*.29411764705882354;\r\n  color+=texture2D(image,uv+(off1/resolution))*.35294117647058826;\r\n  color+=texture2D(image,uv-(off1/resolution))*.35294117647058826;\r\n  return color;\r\n}\r\n// 5x5\r\nvec4 blur9(sampler2D image,vec2 uv,vec2 resolution,vec2 direction){\r\n  vec4 color=vec4(0.);\r\n  vec2 off1=vec2(1.3846153846)*direction;\r\n  vec2 off2=vec2(3.2307692308)*direction;\r\n  color+=texture2D(image,uv)*.2270270270;\r\n  color+=texture2D(image,uv+(off1/resolution))*.3162162162;\r\n  color+=texture2D(image,uv-(off1/resolution))*.3162162162;\r\n  color+=texture2D(image,uv+(off2/resolution))*.0702702703;\r\n  color+=texture2D(image,uv-(off2/resolution))*.0702702703;\r\n  return color;\r\n}\r\n// 7x7\r\nvec4 blur13(sampler2D image,vec2 uv,vec2 resolution,vec2 direction){\r\n  vec4 color=vec4(0.);\r\n  vec2 off1=vec2(1.411764705882353)*direction;\r\n  vec2 off2=vec2(3.2941176470588234)*direction;\r\n  vec2 off3=vec2(5.176470588235294)*direction;\r\n  color+=texture2D(image,uv)*.1964825501511404;\r\n  color+=texture2D(image,uv+(off1/resolution))*.2969069646728344;\r\n  color+=texture2D(image,uv-(off1/resolution))*.2969069646728344;\r\n  color+=texture2D(image,uv+(off2/resolution))*.09447039785044732;\r\n  color+=texture2D(image,uv-(off2/resolution))*.09447039785044732;\r\n  color+=texture2D(image,uv+(off3/resolution))*.010381362401148057;\r\n  color+=texture2D(image,uv-(off3/resolution))*.010381362401148057;\r\n  return color;\r\n}\r\n\r\nvoid main()\r\n{\r\n  vec2 iResolution=uSize/2.;\r\n  \r\n  float offset[4];\r\n  offset[1]=0.;offset[2]=1.3846153846;offset[3]=3.2307692308;\r\n  \r\n  float weight[4];\r\n  weight[1]=.2270270270;weight[2]=.3162162162;weight[3]=.0702702703;\r\n  \r\n  vec4 texCol=texture2D(uSampler,vTextureCoord);\r\n  vec4 texCol0;\r\n  // 垂直\r\n  vec4 color=texCol*weight[0];\r\n  for(int i=1;i<=3;i++){\r\n    texCol0=texture2D(uSampler,vTextureCoord+vec2(0.,offset[i])/iResolution);\r\n    color+=texCol0*weight[i];\r\n    texCol0=texture2D(uSampler,vTextureCoord-vec2(0.,offset[i])/iResolution);\r\n    color+=texCol0*weight[i];\r\n  }\r\n  // 水平\r\n  vec4 color2=texCol*weight[0];\r\n  for(int i=1;i<=3;i++){\r\n    texCol0=texture2D(uSampler,vTextureCoord+vec2(offset[i],0.)/iResolution);\r\n    color2+=texCol0*weight[i];\r\n    texCol0=texture2D(uSampler,vTextureCoord-vec2(offset[i],0.)/iResolution);\r\n    color2+=texCol0*weight[i];\r\n  }\r\n  \r\n  gl_FragColor=texCol+mix(color,color2,.5);\r\n  \r\n  /*vec2 iResolution=uSize/2.;\r\n  vec4 texCol=texture2D(uSampler,vTextureCoord+vec2(10.*sin(vTextureCoord.x*10.5*3.14159),10.*sin(vTextureCoord.y*10.5*3.14159))/iResolution);\r\n  gl_FragColor=texCol;*/\r\n  //gl_FragColor = vec4(vec2(10.*sin(vTextureCoord.x*10.5*3.14159),10.*sin(vTextureCoord.y*10.5*3.14159))/iResolution,0.,1.);\r\n}\r\n\r\n/*precision mediump float;\r\nvarying vec2 vTextureCoord;\r\nuniform sampler2D uSampler;\r\nuniform lowp vec2 uSize;\r\n\r\nfloat CalcGauss(float x,float sigma)\r\n{\r\n  float coeff=1./(2.*3.14157*sigma);\r\n  float expon=-(x*x)/(2.*sigma);\r\n  return(coeff*exp(expon));\r\n}\r\nvoid main()\r\n{\r\n  vec4 texCol=texture2D(uSampler,vTextureCoord);\r\n  vec4 gaussCol=vec4(texCol.rgb,1.);\r\n  const int u_width=10;\r\n  \r\n  for(int j=-u_width;j<=u_width;j++)\r\n  {\r\n    for(int i=-u_width;i<=u_width;i++)\r\n    {\r\n      float r=length(vec2(i,j));\r\n      if(r<float(u_width)){\r\n        float rate=smoothstep(1.,0.,r/float(u_width));\r\n        vec2 actStep=vec2(i,j)/uSize;\r\n        float weight=CalcGauss(rate,1.);\r\n        vec4 texCol0=texture2D(uSampler,vTextureCoord+actStep);\r\n        float power=exp(-(texCol0.r+texCol0.g+texCol0.b)/3.);\r\n        gaussCol+=vec4(power*texCol0.rgb*weight,weight)*rate;\r\n      }\r\n    }\r\n  }\r\n  gaussCol.rgb/=gaussCol.w;\r\n  gl_FragColor=vec4(texCol.rgb+gaussCol.rgb,1.);\r\n}*/\r\n/*precision mediump float;\r\nvarying vec2 vTextureCoord;\r\nuniform sampler2D uSampler;\r\nuniform vec2 uSize;\r\n\r\nfloat CalcGauss(float x,float sigma)\r\n{\r\n  float coeff=1./(2.*3.14157*sigma);\r\n  float expon=-(x*x)/(2.*sigma);\r\n  return(coeff*exp(expon));\r\n}\r\n\r\nvoid main()\r\n{\r\n  vec2 texC=vTextureCoord;\r\n  vec4 texCol=texture2D(uSampler,texC);\r\n  vec4 gaussCol=vec4(texCol.rgb,1.);\r\n  vec2 step=1./uSize;\r\n  const int u_width=10;\r\n  float u_sigma=1.;\r\n  for(int i=1;i<=u_width;++i)\r\n  {\r\n    vec2 actStep=vec2(float(i)*step.x,0.);// this is for the X-axis\r\n    // vec2 actStep = vec2( 0.0, float(i) * step.y );   this would be for the Y-axis\r\n    \r\n    float weight=CalcGauss(float(i)/float(u_width),u_sigma);\r\n    texCol=texture2D(uSampler,texC+actStep);\r\n    gaussCol+=vec4(texCol.rgb*weight,weight);\r\n    texCol=texture2D(uSampler,texC-actStep);\r\n    gaussCol+=vec4(texCol.rgb*weight,weight);\r\n  }\r\n  gaussCol.rgb/=gaussCol.w;\r\n  gl_FragColor=vec4(gaussCol.rgb,1.);\r\n}*/\r\n"},function(e,r){e.exports="attribute vec2 aVertexPosition;\r\nattribute vec4 aVertexColor;\r\nuniform float uFlipY;\r\nuniform vec2 uSize;\r\nvarying lowp vec4 vColor;\r\nvoid main(void){\r\n  vColor=aVertexColor;\r\n  gl_Position=vec4((2.*aVertexPosition/uSize+vec2(-1.,-1.))*vec2(1.,uFlipY),0.,1.);\r\n  //gl_PointSize=10.;\r\n}"},function(e,r){e.exports="precision mediump float;\r\nvarying lowp vec4 vColor;\r\n\r\nvoid main(void){\r\n  gl_FragColor=vColor;\r\n}"},function(e,r){e.exports="attribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\nvarying highp vec2 vTextureCoord;\r\nuniform float uFlipY;\r\nvoid main(void){\r\n  vTextureCoord=aTextureCoord;\r\n  gl_Position=vec4((2.*aVertexPosition+vec2(-1.,-1.))*vec2(1.,uFlipY),0.,1.);\r\n}"},function(e,r){e.exports="precision mediump float;\r\nvarying vec2 vTextureCoord;\r\nuniform sampler2D uSampler;\r\nuniform sampler2D uLineWidthSampler;\r\nuniform lowp vec2 uSize;\r\n\r\nvoid main()\r\n{\r\n  const float pi=3.14159;\r\n  vec4 gaussCol=vec4(0.,0.,0.,0.);\r\n  float sum=0.;\r\n  const int lineWidth=5;\r\n  bool b=false;\r\n  \r\n  gaussCol+=texture2D(uSampler,vTextureCoord);\r\n  sum+=texture2D(uLineWidthSampler,vTextureCoord).r;\r\n  for(int l=0;l<8;l++)\r\n  {\r\n    float angle=2.*pi*float(l)/8.;\r\n    vec2 pos=vec2(cos(angle),sin(angle));\r\n    for(int k=1;k<=lineWidth;k++)\r\n    {\r\n      float r=float(k);\r\n      vec2 coord=vTextureCoord+r*pos/uSize;\r\n      vec4 texCol0=texture2D(uLineWidthSampler,coord);\r\n      if(texCol0.r>0.){\r\n        float rr=float(lineWidth)*texCol0.r;\r\n        if(r<rr){\r\n          vec4 texCol1=texture2D(uSampler,coord);\r\n          float rate=r/rr;\r\n          gaussCol+=vec4(texCol1.rgb,rate);\r\n          sum+=texCol0.r*smoothstep(1.,0.,rate);\r\n        }\r\n      }\r\n    }\r\n  }\r\n  \r\n  /*for(int j=-lineWidth;j<=lineWidth;j++)\r\n  {\r\n    for(int i=-lineWidth;i<=lineWidth;i++)\r\n    {\r\n      vec2 pos=vec2(i,j);\r\n      vec2 coord=vTextureCoord+pos/uSize;\r\n      vec4 texCol0=texture2D(uLineWidthSampler,coord);\r\n      \r\n      if(texCol0.r>0.){\r\n        float r=length(pos);\r\n        float rr=float(lineWidth)*texCol0.r;\r\n        \r\n        if(r<rr){\r\n          vec4 texCol1=texture2D(uSampler,coord);\r\n          float rate=r/rr;\r\n          gaussCol+=vec4(texCol1.rgb,rate);\r\n          sum+=texCol0.r*smoothstep(1.,0.,rate);\r\n        }\r\n      }\r\n    }\r\n  }*/\r\n  /*if(b||sum>1.){\r\n    sum=1.;\r\n  }*/\r\n  gaussCol.rgb/=gaussCol.w;\r\n  \r\n  gl_FragColor=vec4(gaussCol.rgb*sum,1.);\r\n  \r\n}"},,,,,,,,,,,,,,,,,,,,,,,function(e,r,t){"use strict";t.r(r);var n=t(0),o=t(3);function i(e,r,t){var o,i=Object(n.e)(e,r,t);return{program:i,attribLocations:{vertexPosition:(o=e.getAttribLocation(i,"aVertexPosition"),function(r){e.bindBuffer(e.ARRAY_BUFFER,r),e.vertexAttribPointer(o,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(o)}),textureCoord:function(){var r=e.getAttribLocation(i,"aTextureCoord");return function(t){e.bindBuffer(e.ARRAY_BUFFER,t),e.vertexAttribPointer(r,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(r)}}()},uniformLocations:{flipY:function(){var r=e.getUniformLocation(i,"uFlipY");return function(t){e.uniform1f(r,t)}}(),sampler:function(){var r=e.getUniformLocation(i,"uSampler");return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e.activeTexture(e.TEXTURE0+n),e.bindTexture(e.TEXTURE_2D,t),e.uniform1i(r,n)}}(),lineWidthSampler:function(){var r=e.getUniformLocation(i,"uLineWidthSampler");return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;e.activeTexture(e.TEXTURE0+n),e.bindTexture(e.TEXTURE_2D,t),e.uniform1i(r,n)}}(),size:function(){var r=e.getUniformLocation(i,"uSize");return function(t){e.uniform2fv(r,t)}}()}}}function a(e,r,t){var o,i=Object(n.e)(e,r,t);return{program:i,attribLocations:{vertexPosition:(o=e.getAttribLocation(i,"aVertexPosition"),function(r){e.bindBuffer(e.ARRAY_BUFFER,r),e.vertexAttribPointer(o,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(o)}),textureCoord:function(){var r=e.getAttribLocation(i,"aTextureCoord");return function(t){e.bindBuffer(e.ARRAY_BUFFER,t),e.vertexAttribPointer(r,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(r)}}()},uniformLocations:{flipY:function(){var r=e.getUniformLocation(i,"uFlipY");return function(t){e.uniform1f(r,t)}}(),sampler:function(){var r=e.getUniformLocation(i,"uSampler");return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e.activeTexture(e.TEXTURE0+n),e.bindTexture(e.TEXTURE_2D,t),e.uniform1i(r,n)}}(),size:function(){var r=e.getUniformLocation(i,"uSize");return function(t){e.uniform2fv(r,t)}}(),mouse:function(){var r=e.getUniformLocation(i,"uMouse");return function(t){e.uniform2fv(r,t)}}()}}}function u(e){var r=[[0,0],[1,0],[1,1],[0,1]].flat(),t=Object(n.a)(e,r,2),o=[[0,0],[1,0],[1,1],[0,1]].flat(),i=Object(n.a)(e,o,2),a=[[0,1,3],[1,2,3]].flat();return{positionBufferData:t,textureCoordinatesBufferData:i,indicesBufferData:Object(n.d)(e,a)}}function f(e,r,t){var o,i=Object(n.e)(e,r,t);return{program:i,attribLocations:{vertexPosition:(o=e.getAttribLocation(i,"aVertexPosition"),function(r){e.bindBuffer(e.ARRAY_BUFFER,r),e.vertexAttribPointer(o,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(o)}),vertexColor:function(){var r=e.getAttribLocation(i,"aVertexColor");return function(t){e.bindBuffer(e.ARRAY_BUFFER,t),e.vertexAttribPointer(r,4,e.FLOAT,!1,0,0),e.enableVertexAttribArray(r)}}()},uniformLocations:{flipY:function(){var r=e.getUniformLocation(i,"uFlipY");return function(t){e.uniform1f(r,t)}}(),size:function(){var r=e.getUniformLocation(i,"uSize");return function(t){e.uniform2fv(r,t)}}()}}}function l(e){return{positionBufferData:Object(n.a)(e,[],2,e.DYNAMIC_DRAW),colorBufferData:Object(n.a)(e,[],4,e.DYNAMIC_DRAW),lineWidthBufferData:Object(n.a)(e,[],4,e.DYNAMIC_DRAW)}}!function(){var e=document.querySelector("#glcanvas"),r=e.getContext("webgl");if(!r)return void alert("無法初始化WebGL。您的瀏覽器或機器可能不支持它。");var c={glowShader:a(r,t(6),t(7)),lineShader:f(r,t(8),t(9)),lineWidthShader:i(r,t(10),t(11))},v={face:u(r),line:l(r)},s=[0,0];e.addEventListener("mousemove",(function(e){o.b.set(s,e.pageX,e.pageY)}));var d={line:Object(n.b)(r),lineWidth:Object(n.b)(r),glow:Object(n.b)(r)};Object(n.c)(r,2);v.line.positionBufferData.set([[0,0],[150,100],[200,200],[400,200]].flat()),v.line.colorBufferData.set([[1,1,1,1],[1,0,0,1],[0,1,0,1],[0,0,1,1]].flat()),v.line.lineWidthBufferData.set([[1,0,0,0],[.2,0,0,0],[.5,0,0,0],[0,0,0,0]].flat()),e.addEventListener("mousedown",(function(e){o.b.set(s,e.pageX,e.pageY),v.line.positionBufferData.add(s),v.line.colorBufferData.add([Math.random(),Math.random(),Math.random(),1]),v.line.lineWidthBufferData.add([.2+.8*Math.random(),0,0,1]),console.log(v.line.positionBufferData.length/2)}));var g=0;requestAnimationFrame((function e(t){var o=.001*(t-g);g=t,requestAnimationFrame(e),function(e,r,t,o,i,a,u,f){var l=o.line,c=l.positionBufferData.getItem(0);c[0]+=50*e,c[0]%=100,l.positionBufferData.item(0,c);var v=l.positionBufferData.getItem(2);v[1]+=50*e,v[1]%=100,l.positionBufferData.item(2,v);var s=t.lineShader;r.useProgram(s.program),s.attribLocations.vertexPosition(l.positionBufferData.buffer),s.uniformLocations.size([r.canvas.clientWidth,r.canvas.clientHeight]),s.uniformLocations.flipY(1),Object(n.g)(r,u.line.framebuffer,r.canvas.width,r.canvas.height),r.clearColor(0,0,0,1),r.clear(r.COLOR_BUFFER_BIT),s.attribLocations.vertexColor(l.colorBufferData.buffer),r.drawArrays(r.LINE_STRIP,0,l.positionBufferData.data.length/2),Object(n.g)(r,u.lineWidth.framebuffer,r.canvas.width,r.canvas.height),r.clearColor(0,0,0,1),r.clear(r.COLOR_BUFFER_BIT),s.attribLocations.vertexColor(l.lineWidthBufferData.buffer),r.drawArrays(r.LINE_STRIP,0,l.positionBufferData.data.length/2);var d=o.face,g=t.lineWidthShader;r.useProgram(g.program),g.attribLocations.vertexPosition(d.positionBufferData.buffer),g.attribLocations.textureCoord(d.textureCoordinatesBufferData.buffer),g.uniformLocations.flipY(1),g.uniformLocations.sampler(u.line.texture),g.uniformLocations.lineWidthSampler(u.lineWidth.texture),g.uniformLocations.size([r.canvas.clientWidth,r.canvas.clientHeight]),Object(n.g)(r,u.glow.framebuffer,r.canvas.width,r.canvas.height),r.clearColor(0,0,0,1),r.clear(r.COLOR_BUFFER_BIT),r.drawElements(r.TRIANGLE_STRIP,d.indicesBufferData.length,r.UNSIGNED_BYTE,0);var m=o.face,x=t.glowShader;r.useProgram(x.program),x.attribLocations.vertexPosition(m.positionBufferData.buffer),x.attribLocations.textureCoord(m.textureCoordinatesBufferData.buffer),x.uniformLocations.flipY(1),x.uniformLocations.sampler(u.glow.texture),x.uniformLocations.size([r.canvas.clientWidth,r.canvas.clientHeight]),x.uniformLocations.mouse(a),Object(n.g)(r,null,r.canvas.width,r.canvas.height),r.clearColor(0,0,0,1),r.clear(r.COLOR_BUFFER_BIT),x.uniformLocations.flipY(-1),r.drawElements(r.TRIANGLE_STRIP,m.indicesBufferData.length,r.UNSIGNED_BYTE,0)}(o,r,c,v,0,s,d)}))}()}]);