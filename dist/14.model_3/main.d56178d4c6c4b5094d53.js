!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=86)}([function(t,e,n){"use strict";n.d(e,"g",(function(){return r})),n.d(e,"a",(function(){return a})),n.d(e,"d",(function(){return i})),n.d(e,"h",(function(){return f})),n.d(e,"c",(function(){return l})),n.d(e,"b",(function(){return d})),n.d(e,"j",(function(){return v})),n.d(e,"i",(function(){return h})),n.d(e,"e",(function(){return p})),n.d(e,"f",(function(){return m})),n.d(e,"k",(function(){return x}));var r=function(t,e,n){var r=o(t,t.VERTEX_SHADER,e),a=o(t,t.FRAGMENT_SHADER,n),i=t.createProgram();return t.attachShader(i,r),t.attachShader(i,a),t.linkProgram(i),t.getProgramParameter(i,t.LINK_STATUS)?i:(alert("無法初始化著色器程序: "+t.getProgramInfoLog(i)),null)},o=function(t,e,n){var r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)?r:(alert("編譯著色器時發生錯誤: "+t.getShaderInfoLog(r)),t.deleteShader(r),null)},a=function(t,e,n){var r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Float32Array,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:t.STATIC_DRAW,i=t.createBuffer(),u=0,f={buffer:i,get data(){return r},get length(){return r.length},set:function(e){r=new o(e),u=100*Math.ceil(r.length/n/100),t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,u*n*4,a),t.bufferSubData(t.ARRAY_BUFFER,0,r)},add:function(e){var f=r.length,c=100*Math.floor(r.length/n/100);c>=u&&(u=c+100,t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,u*n*4,a),t.bufferSubData(t.ARRAY_BUFFER,0,r));var s=new o(f+n);s.set(r),r=s,this.item(f/n,e)},item:function(e,a){var u=new o(a);r.set(u,e*n),t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferSubData(t.ARRAY_BUFFER,e*n*4,u)},getItem:function(t){return Array.from(r.slice(t*n,(t+1)*n))}};return f.set(e),f},i=function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Uint8Array,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.STATIC_DRAW,a=t.createBuffer(),i=0,u=3,f={buffer:a,get data(){return n},get length(){return n.length},set:function(e){n=new r(e),i=100*Math.ceil(n.length/u/100),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,a),t.bufferData(t.ELEMENT_ARRAY_BUFFER,i*u*4,o),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,n)},add:function(e){var f=n.length,c=100*Math.floor(n.length/u/100);c>=i&&(i=c+100,t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,a),t.bufferData(t.ELEMENT_ARRAY_BUFFER,i*u*4,o),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,n));var s=new r(f+u);s.set(n),n=s,this.item(f/u,e)},item:function(e,o){var i=new r(o);n.set(i,e*u),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,a),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,e*u*4,i)},getItem:function(t){return Array.from(n.slice(t*u,(t+1)*u))}};return f.set(e),f},u=function(t){var e=t.createTexture();return t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),e},f=function(t,e){var n=u(t),r=new Image;return r.onload=function(){n.width=r.width,n.height=r.height,t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r),t.bindTexture(t.TEXTURE_2D,null)},r.src=e,n},c=function(t,e,n,r){t.bindFramebuffer(t.FRAMEBUFFER,e),void 0!==n&&void 0!==r&&t.viewport(0,0,n,r)},s=function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];e?n?c(t,e.framebuffer,e.width,e.height):c(t,e.framebuffer):n?c(t,null,t.canvas.width,t.canvas.height):c(t,null)},l=function(t,e,n){var r={width:e||t.canvas.clientWidth,height:n||t.canvas.clientHeight},o=u(t);r.texture=o,t.texImage2D(t.TEXTURE_2D,0,t.RGBA,r.width,r.height,0,t.RGBA,t.UNSIGNED_BYTE,null);var a=t.createFramebuffer();return r.framebuffer=a,t.bindFramebuffer(t.FRAMEBUFFER,a),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,o,0),t.bindFramebuffer(t.FRAMEBUFFER,null),r},d={attribFloat:function(t,e,n,r){var o=t.getAttribLocation(e,n);return t.enableVertexAttribArray(o),function(e){t.bindBuffer(t.ARRAY_BUFFER,e),t.vertexAttribPointer(o,r,t.FLOAT,!1,0,0)}}},v={uniform1f:function(t,e,n){var r=t.getUniformLocation(e,n);return function(e){t.uniform1f(r,e)}},uniform1fv:function(t,e,n){var r=t.getUniformLocation(e,n);return function(e){t.uniform1fv(r,e)}},uniform2fv:function(t,e,n){var r=t.getUniformLocation(e,n);return function(e){t.uniform2fv(r,e)}},uniform3fv:function(t,e,n){var r=t.getUniformLocation(e,n);return function(e){t.uniform3fv(r,e)}},uniformTexture:function(t,e,n,r){var o=t.getUniformLocation(e,n);return function(e){t.activeTexture(t.TEXTURE0+r),t.bindTexture(t.TEXTURE_2D,e),t.uniform1i(o,r)}},uniform1i:function(t,e,n){var r=t.getUniformLocation(e,n);return function(e){t.uniform1i(r,e)}},uniformMatrix4fv:function(t,e,n){var r=t.getUniformLocation(e,n);return function(e){t.uniformMatrix4fv(r,!1,e)}}},h=function(t,e,n,r,o){var a=e(t,n,r);return{programInfo:a,use:function(){t.useProgram(a.program)},attribSet:function(t){for(var e in t)a.attribLocations[e]&&a.attribLocations[e](t[e])},uniformSet:function(t){for(var e in t)a.uniformLocations[e]&&a.uniformLocations[e](t[e])},elementSet:function(e){t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e)}}},p=function(t){return[[t[0],t[1]],[t[2],t[1]],[t[2],t[3]],[t[0],t[3]]].flat()},m=function(t){return[[t[0],t[1]],[t[0],t[3]],[t[2],t[1]],[t[2],t[3]]].flat()},g=function(t){t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT)},x=function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];s(t,e,r),n&&g(t)}},function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return l})),n.d(e,"a",(function(){return d})),n.d(e,"e",(function(){return g})),n.d(e,"d",(function(){return x}));var r=n(2),o=n.n(r),a=n(4),i=n.n(a),u=n(5),f=n.n(u),c=n(3),s=function(){function t(){i()(this,t)}return f()(t,null,[{key:"zero",value:function(){return[0,0]}},{key:"clone",value:function(t){return o()(t)}},{key:"normalize",value:function(e){var n=t.length(e);return n?t.scale(e,1/n):e}},{key:"rotate",value:function(t,e){var n=Math.cos(e),r=Math.sin(e);return[t[0]*n-t[1]*r,t[1]*n+t[0]*r]}},{key:"dot",value:function(t,e){return t[0]*e[0]+t[1]*e[1]}},{key:"cross",value:function(t,e){return t[0]*e[1]-t[1]*e[0]}},{key:"add",value:function(t,e){return[t[0]+e[0],t[1]+e[1]]}},{key:"sub",value:function(t,e){return[t[0]-e[0],t[1]-e[1]]}},{key:"projection",value:function(e,n){var r=t.dot(e,n)/t.dot(n,n);return[n[0]*r,n[1]*r]}},{key:"length",value:function(e){return Math.sqrt(t.dot(e,e))}},{key:"mul",value:function(t,e){return[t[0]*e[0],t[1]*e[1]]}},{key:"div",value:function(t,e){return[t[0]/e[0],t[1]/e[1]]}},{key:"scale",value:function(t,e){return[t[0]*e,t[1]*e]}},{key:"collisionCalc",value:function(e,n,r,o){return t.scale(t.add(t.scale(e,r-o),t.scale(n,2*o)),1/(r+o))}},{key:"getAngle",value:function(t){return Math.atan2(t[1],t[0])}},{key:"floor",value:function(t){return[Math.floor(t[0]),Math.floor(t[1])]}},{key:"fract",value:function(t){return[c.a.fract(t[0]),c.a.fract(t[1])]}},{key:"sin",value:function(t){return[Math.sin(t[0]),Math.sin(t[1])]}},{key:"cos",value:function(t){return[Math.cos(t[0]),Math.cos(t[1])]}},{key:"distance",value:function(e,n){return t.length(t.sub(n,e))}},{key:"mix",value:function(t,e,n){return[c.a.mix(t[0],e[0],n),c.a.mix(t[1],e[1],n)]}},{key:"abs",value:function(t){return[Math.abs(t[0]),Math.abs(t[1])]}}]),t}(),l=function(){function t(){i()(this,t)}return f()(t,null,[{key:"set",value:function(t,e,n){return t[0]=e,t[1]=n,t}},{key:"normalize",value:function(e){var n=s.length(e);return n&&t.scale(e,1/n),e}},{key:"add",value:function(t,e){return t[0]+=e[0],t[1]+=e[1],t}},{key:"sub",value:function(t,e){return t[0]-=e[0],t[1]-=e[1],t}},{key:"scale",value:function(t,e){return t[0]*=e,t[1]*=e,t}},{key:"rotate",value:function(t,e){var n=Math.cos(e),r=Math.sin(e),o=[t[0]*n-t[1]*r,t[1]*n+t[0]*r];return t[0]=o[0],t[1]=o[1],t}}]),t}(),d=function(){function t(){i()(this,t)}return f()(t,null,[{key:"doLineSegmentsIntersect",value:function(t,e,n,r){function o(t,e,n){var r=(e[1]-t[1])*(n[0]-e[0])-(e[0]-t[0])*(n[1]-e[1]);return 0===r?0:r>0?1:2}function a(t,e,n){return e[0]<=Math.max(t[0],n[0])&&e[0]>=Math.min(t[0],n[0])&&e[1]<=Math.max(t[1],n[1])&&e[1]>=Math.min(t[1],n[1])}var i=o(t,e,n),u=o(t,e,r),f=o(n,r,t),c=o(n,r,e);return i!==u&&f!==c||(!(0!==i||!a(t,n,e))||(!(0!==u||!a(t,r,e))||(!(0!==f||!a(n,t,r))||!(0!==c||!a(n,e,r)))))}},{key:"getLine",value:function(t,e){return{pos:t,dir:s.sub(e,t)}}},{key:"toLineDistance",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=s.sub(n,e),a=o[1],i=-o[0],u=-e[0]*o[1]+o[0]*e[1],f=(t[0]*a+t[1]*i+u)/s.length(o);return r?f:Math.abs(f)}}]),t}(),v=function(t,e,n,r){var o=r*r;return[t[0]*(o-2*r+1)+2*e[0]*(1-r)*r+n[0]*o,t[1]*(o-2*r+1)+2*e[1]*(1-r)*r+n[1]*o]},h=function(t,e,n,r){return[2*r*(t[0]-2*e[0]+n[0])+2*(-t[0]+e[0]),2*r*(t[1]-2*e[1]+n[1])+2*(-t[1]+e[1])]},p=function(t,e,n,r,o){var a=o*o,i=o*o*o;return[t[0]*(3*a-i-3*o+1)+e[0]*(3*i-6*a+3*o)+n[0]*(-3*i+3*a)+r[0]*i,t[1]*(3*a-i-3*o+1)+e[1]*(3*i-6*a+3*o)+n[1]*(-3*i+3*a)+r[1]*i]},m=function(t,e,n,r,o){var a=o*o;return[-3*t[0]+3*e[0]+2*o*(3*t[0]-6*e[0]+3*n[0])+3*a*(-t[0]+3*e[0]-3*n[0]+r[0]),-3*t[1]+3*e[1]+2*o*(3*t[1]-6*e[1]+3*n[1])+3*a*(-t[1]+3*e[1]-3*n[1]+r[1])]},g=function(t,e,n,r){for(var o=[],a=[],i=null,u=0;u<r;u++){var f=u/(r-1),c=v(t,e,n,f),l=s.normalize(h(t,e,n,f));o.push({p:c,t:l,n:[-l[1],l[0]]}),i&&a.push(s.distance(c,i)),i=c}var d=a.reduce((function(t,e){return t+e}));return{points:o,section:a,length:d}},x=function(t,e,n,r,o){for(var a=[],i=[],u=null,f=0;f<o;f++){var c=f/(o-1),l=p(t,e,n,r,c),d=s.normalize(m(t,e,n,r,c));a.push({p:l,t:d,n:[-d[1],d[0]]}),u&&i.push(s.distance(l,u)),u=l}var v=i.reduce((function(t,e){return t+e}));return{points:a,section:i,length:v}}},function(t,e,n){var r=n(12),o=n(13),a=n(11),i=n(14);t.exports=function(t){return r(t)||o(t)||a(t)||i()}},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(4),o=n.n(r),a=n(5),i=n.n(a),u=function(){function t(){o()(this,t)}return i()(t,null,[{key:"mix",value:function(t,e,n){return t*(1-n)+e*n}},{key:"fract",value:function(t){return(t%=1)<0?t+1:t}},{key:"inverseMix",value:function(t,e,n){return(n-t)/(e-t)}},{key:"clamp",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return t<=e?e:t>=n?n:t}},{key:"smoothstep",value:function(t,e,n){return(n=clamp(inverseMix(t,e,n)))*n*(3-2*n)}}]),t}()},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}},,function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r={};n.r(r),n.d(r,"create",(function(){return i})),n.d(r,"clone",(function(){return u})),n.d(r,"copy",(function(){return f})),n.d(r,"fromValues",(function(){return c})),n.d(r,"set",(function(){return s})),n.d(r,"identity",(function(){return l})),n.d(r,"transpose",(function(){return d})),n.d(r,"invert",(function(){return v})),n.d(r,"adjoint",(function(){return h})),n.d(r,"determinant",(function(){return p})),n.d(r,"multiply",(function(){return m})),n.d(r,"translate",(function(){return g})),n.d(r,"scale",(function(){return x})),n.d(r,"rotate",(function(){return b})),n.d(r,"rotateX",(function(){return M})),n.d(r,"rotateY",(function(){return y})),n.d(r,"rotateZ",(function(){return w})),n.d(r,"fromTranslation",(function(){return R})),n.d(r,"fromScaling",(function(){return S})),n.d(r,"fromRotation",(function(){return C})),n.d(r,"fromXRotation",(function(){return T})),n.d(r,"fromYRotation",(function(){return D})),n.d(r,"fromZRotation",(function(){return E})),n.d(r,"fromRotationTranslation",(function(){return P})),n.d(r,"fromQuat2",(function(){return _})),n.d(r,"getTranslation",(function(){return j})),n.d(r,"getScaling",(function(){return F})),n.d(r,"getRotation",(function(){return k})),n.d(r,"fromRotationTranslationScale",(function(){return A})),n.d(r,"fromRotationTranslationScaleOrigin",(function(){return L})),n.d(r,"fromQuat",(function(){return B})),n.d(r,"frustum",(function(){return O})),n.d(r,"perspective",(function(){return U})),n.d(r,"perspectiveFromFieldOfView",(function(){return N})),n.d(r,"ortho",(function(){return I})),n.d(r,"lookAt",(function(){return z})),n.d(r,"targetTo",(function(){return V})),n.d(r,"str",(function(){return G})),n.d(r,"frob",(function(){return Y})),n.d(r,"add",(function(){return W})),n.d(r,"subtract",(function(){return X})),n.d(r,"multiplyScalar",(function(){return Q})),n.d(r,"multiplyScalarAndAdd",(function(){return q})),n.d(r,"exactEquals",(function(){return H})),n.d(r,"equals",(function(){return Z})),n.d(r,"mul",(function(){return K})),n.d(r,"sub",(function(){return $}));var o=1e-6,a="undefined"!=typeof Float32Array?Float32Array:Array;Math.random;Math.PI;function i(){var t=new a(16);return a!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function u(t){var e=new a(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function f(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function c(t,e,n,r,o,i,u,f,c,s,l,d,v,h,p,m){var g=new a(16);return g[0]=t,g[1]=e,g[2]=n,g[3]=r,g[4]=o,g[5]=i,g[6]=u,g[7]=f,g[8]=c,g[9]=s,g[10]=l,g[11]=d,g[12]=v,g[13]=h,g[14]=p,g[15]=m,g}function s(t,e,n,r,o,a,i,u,f,c,s,l,d,v,h,p,m){return t[0]=e,t[1]=n,t[2]=r,t[3]=o,t[4]=a,t[5]=i,t[6]=u,t[7]=f,t[8]=c,t[9]=s,t[10]=l,t[11]=d,t[12]=v,t[13]=h,t[14]=p,t[15]=m,t}function l(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function d(t,e){if(t===e){var n=e[1],r=e[2],o=e[3],a=e[6],i=e[7],u=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=a,t[11]=e[14],t[12]=o,t[13]=i,t[14]=u}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function v(t,e){var n=e[0],r=e[1],o=e[2],a=e[3],i=e[4],u=e[5],f=e[6],c=e[7],s=e[8],l=e[9],d=e[10],v=e[11],h=e[12],p=e[13],m=e[14],g=e[15],x=n*u-r*i,b=n*f-o*i,M=n*c-a*i,y=r*f-o*u,w=r*c-a*u,R=o*c-a*f,S=s*p-l*h,C=s*m-d*h,T=s*g-v*h,D=l*m-d*p,E=l*g-v*p,P=d*g-v*m,_=x*P-b*E+M*D+y*T-w*C+R*S;return _?(_=1/_,t[0]=(u*P-f*E+c*D)*_,t[1]=(o*E-r*P-a*D)*_,t[2]=(p*R-m*w+g*y)*_,t[3]=(d*w-l*R-v*y)*_,t[4]=(f*T-i*P-c*C)*_,t[5]=(n*P-o*T+a*C)*_,t[6]=(m*M-h*R-g*b)*_,t[7]=(s*R-d*M+v*b)*_,t[8]=(i*E-u*T+c*S)*_,t[9]=(r*T-n*E-a*S)*_,t[10]=(h*w-p*M+g*x)*_,t[11]=(l*M-s*w-v*x)*_,t[12]=(u*C-i*D-f*S)*_,t[13]=(n*D-r*C+o*S)*_,t[14]=(p*b-h*y-m*x)*_,t[15]=(s*y-l*b+d*x)*_,t):null}function h(t,e){var n=e[0],r=e[1],o=e[2],a=e[3],i=e[4],u=e[5],f=e[6],c=e[7],s=e[8],l=e[9],d=e[10],v=e[11],h=e[12],p=e[13],m=e[14],g=e[15];return t[0]=u*(d*g-v*m)-l*(f*g-c*m)+p*(f*v-c*d),t[1]=-(r*(d*g-v*m)-l*(o*g-a*m)+p*(o*v-a*d)),t[2]=r*(f*g-c*m)-u*(o*g-a*m)+p*(o*c-a*f),t[3]=-(r*(f*v-c*d)-u*(o*v-a*d)+l*(o*c-a*f)),t[4]=-(i*(d*g-v*m)-s*(f*g-c*m)+h*(f*v-c*d)),t[5]=n*(d*g-v*m)-s*(o*g-a*m)+h*(o*v-a*d),t[6]=-(n*(f*g-c*m)-i*(o*g-a*m)+h*(o*c-a*f)),t[7]=n*(f*v-c*d)-i*(o*v-a*d)+s*(o*c-a*f),t[8]=i*(l*g-v*p)-s*(u*g-c*p)+h*(u*v-c*l),t[9]=-(n*(l*g-v*p)-s*(r*g-a*p)+h*(r*v-a*l)),t[10]=n*(u*g-c*p)-i*(r*g-a*p)+h*(r*c-a*u),t[11]=-(n*(u*v-c*l)-i*(r*v-a*l)+s*(r*c-a*u)),t[12]=-(i*(l*m-d*p)-s*(u*m-f*p)+h*(u*d-f*l)),t[13]=n*(l*m-d*p)-s*(r*m-o*p)+h*(r*d-o*l),t[14]=-(n*(u*m-f*p)-i*(r*m-o*p)+h*(r*f-o*u)),t[15]=n*(u*d-f*l)-i*(r*d-o*l)+s*(r*f-o*u),t}function p(t){var e=t[0],n=t[1],r=t[2],o=t[3],a=t[4],i=t[5],u=t[6],f=t[7],c=t[8],s=t[9],l=t[10],d=t[11],v=t[12],h=t[13],p=t[14],m=t[15];return(e*i-n*a)*(l*m-d*p)-(e*u-r*a)*(s*m-d*h)+(e*f-o*a)*(s*p-l*h)+(n*u-r*i)*(c*m-d*v)-(n*f-o*i)*(c*p-l*v)+(r*f-o*u)*(c*h-s*v)}function m(t,e,n){var r=e[0],o=e[1],a=e[2],i=e[3],u=e[4],f=e[5],c=e[6],s=e[7],l=e[8],d=e[9],v=e[10],h=e[11],p=e[12],m=e[13],g=e[14],x=e[15],b=n[0],M=n[1],y=n[2],w=n[3];return t[0]=b*r+M*u+y*l+w*p,t[1]=b*o+M*f+y*d+w*m,t[2]=b*a+M*c+y*v+w*g,t[3]=b*i+M*s+y*h+w*x,b=n[4],M=n[5],y=n[6],w=n[7],t[4]=b*r+M*u+y*l+w*p,t[5]=b*o+M*f+y*d+w*m,t[6]=b*a+M*c+y*v+w*g,t[7]=b*i+M*s+y*h+w*x,b=n[8],M=n[9],y=n[10],w=n[11],t[8]=b*r+M*u+y*l+w*p,t[9]=b*o+M*f+y*d+w*m,t[10]=b*a+M*c+y*v+w*g,t[11]=b*i+M*s+y*h+w*x,b=n[12],M=n[13],y=n[14],w=n[15],t[12]=b*r+M*u+y*l+w*p,t[13]=b*o+M*f+y*d+w*m,t[14]=b*a+M*c+y*v+w*g,t[15]=b*i+M*s+y*h+w*x,t}function g(t,e,n){var r,o,a,i,u,f,c,s,l,d,v,h,p=n[0],m=n[1],g=n[2];return e===t?(t[12]=e[0]*p+e[4]*m+e[8]*g+e[12],t[13]=e[1]*p+e[5]*m+e[9]*g+e[13],t[14]=e[2]*p+e[6]*m+e[10]*g+e[14],t[15]=e[3]*p+e[7]*m+e[11]*g+e[15]):(r=e[0],o=e[1],a=e[2],i=e[3],u=e[4],f=e[5],c=e[6],s=e[7],l=e[8],d=e[9],v=e[10],h=e[11],t[0]=r,t[1]=o,t[2]=a,t[3]=i,t[4]=u,t[5]=f,t[6]=c,t[7]=s,t[8]=l,t[9]=d,t[10]=v,t[11]=h,t[12]=r*p+u*m+l*g+e[12],t[13]=o*p+f*m+d*g+e[13],t[14]=a*p+c*m+v*g+e[14],t[15]=i*p+s*m+h*g+e[15]),t}function x(t,e,n){var r=n[0],o=n[1],a=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*o,t[5]=e[5]*o,t[6]=e[6]*o,t[7]=e[7]*o,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function b(t,e,n,r){var a,i,u,f,c,s,l,d,v,h,p,m,g,x,b,M,y,w,R,S,C,T,D,E,P=r[0],_=r[1],j=r[2],F=Math.hypot(P,_,j);return F<o?null:(P*=F=1/F,_*=F,j*=F,a=Math.sin(n),u=1-(i=Math.cos(n)),f=e[0],c=e[1],s=e[2],l=e[3],d=e[4],v=e[5],h=e[6],p=e[7],m=e[8],g=e[9],x=e[10],b=e[11],M=P*P*u+i,y=_*P*u+j*a,w=j*P*u-_*a,R=P*_*u-j*a,S=_*_*u+i,C=j*_*u+P*a,T=P*j*u+_*a,D=_*j*u-P*a,E=j*j*u+i,t[0]=f*M+d*y+m*w,t[1]=c*M+v*y+g*w,t[2]=s*M+h*y+x*w,t[3]=l*M+p*y+b*w,t[4]=f*R+d*S+m*C,t[5]=c*R+v*S+g*C,t[6]=s*R+h*S+x*C,t[7]=l*R+p*S+b*C,t[8]=f*T+d*D+m*E,t[9]=c*T+v*D+g*E,t[10]=s*T+h*D+x*E,t[11]=l*T+p*D+b*E,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function M(t,e,n){var r=Math.sin(n),o=Math.cos(n),a=e[4],i=e[5],u=e[6],f=e[7],c=e[8],s=e[9],l=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*o+c*r,t[5]=i*o+s*r,t[6]=u*o+l*r,t[7]=f*o+d*r,t[8]=c*o-a*r,t[9]=s*o-i*r,t[10]=l*o-u*r,t[11]=d*o-f*r,t}function y(t,e,n){var r=Math.sin(n),o=Math.cos(n),a=e[0],i=e[1],u=e[2],f=e[3],c=e[8],s=e[9],l=e[10],d=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*o-c*r,t[1]=i*o-s*r,t[2]=u*o-l*r,t[3]=f*o-d*r,t[8]=a*r+c*o,t[9]=i*r+s*o,t[10]=u*r+l*o,t[11]=f*r+d*o,t}function w(t,e,n){var r=Math.sin(n),o=Math.cos(n),a=e[0],i=e[1],u=e[2],f=e[3],c=e[4],s=e[5],l=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*o+c*r,t[1]=i*o+s*r,t[2]=u*o+l*r,t[3]=f*o+d*r,t[4]=c*o-a*r,t[5]=s*o-i*r,t[6]=l*o-u*r,t[7]=d*o-f*r,t}function R(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function S(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function C(t,e,n){var r,a,i,u=n[0],f=n[1],c=n[2],s=Math.hypot(u,f,c);return s<o?null:(u*=s=1/s,f*=s,c*=s,r=Math.sin(e),i=1-(a=Math.cos(e)),t[0]=u*u*i+a,t[1]=f*u*i+c*r,t[2]=c*u*i-f*r,t[3]=0,t[4]=u*f*i-c*r,t[5]=f*f*i+a,t[6]=c*f*i+u*r,t[7]=0,t[8]=u*c*i+f*r,t[9]=f*c*i-u*r,t[10]=c*c*i+a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function T(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function D(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function E(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function P(t,e,n){var r=e[0],o=e[1],a=e[2],i=e[3],u=r+r,f=o+o,c=a+a,s=r*u,l=r*f,d=r*c,v=o*f,h=o*c,p=a*c,m=i*u,g=i*f,x=i*c;return t[0]=1-(v+p),t[1]=l+x,t[2]=d-g,t[3]=0,t[4]=l-x,t[5]=1-(s+p),t[6]=h+m,t[7]=0,t[8]=d+g,t[9]=h-m,t[10]=1-(s+v),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function _(t,e){var n=new a(3),r=-e[0],o=-e[1],i=-e[2],u=e[3],f=e[4],c=e[5],s=e[6],l=e[7],d=r*r+o*o+i*i+u*u;return d>0?(n[0]=2*(f*u+l*r+c*i-s*o)/d,n[1]=2*(c*u+l*o+s*r-f*i)/d,n[2]=2*(s*u+l*i+f*o-c*r)/d):(n[0]=2*(f*u+l*r+c*i-s*o),n[1]=2*(c*u+l*o+s*r-f*i),n[2]=2*(s*u+l*i+f*o-c*r)),P(t,e,n),t}function j(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function F(t,e){var n=e[0],r=e[1],o=e[2],a=e[4],i=e[5],u=e[6],f=e[8],c=e[9],s=e[10];return t[0]=Math.hypot(n,r,o),t[1]=Math.hypot(a,i,u),t[2]=Math.hypot(f,c,s),t}function k(t,e){var n=new a(3);F(n,e);var r=1/n[0],o=1/n[1],i=1/n[2],u=e[0]*r,f=e[1]*o,c=e[2]*i,s=e[4]*r,l=e[5]*o,d=e[6]*i,v=e[8]*r,h=e[9]*o,p=e[10]*i,m=u+l+p,g=0;return m>0?(g=2*Math.sqrt(m+1),t[3]=.25*g,t[0]=(d-h)/g,t[1]=(v-c)/g,t[2]=(f-s)/g):u>l&&u>p?(g=2*Math.sqrt(1+u-l-p),t[3]=(d-h)/g,t[0]=.25*g,t[1]=(f+s)/g,t[2]=(v+c)/g):l>p?(g=2*Math.sqrt(1+l-u-p),t[3]=(v-c)/g,t[0]=(f+s)/g,t[1]=.25*g,t[2]=(d+h)/g):(g=2*Math.sqrt(1+p-u-l),t[3]=(f-s)/g,t[0]=(v+c)/g,t[1]=(d+h)/g,t[2]=.25*g),t}function A(t,e,n,r){var o=e[0],a=e[1],i=e[2],u=e[3],f=o+o,c=a+a,s=i+i,l=o*f,d=o*c,v=o*s,h=a*c,p=a*s,m=i*s,g=u*f,x=u*c,b=u*s,M=r[0],y=r[1],w=r[2];return t[0]=(1-(h+m))*M,t[1]=(d+b)*M,t[2]=(v-x)*M,t[3]=0,t[4]=(d-b)*y,t[5]=(1-(l+m))*y,t[6]=(p+g)*y,t[7]=0,t[8]=(v+x)*w,t[9]=(p-g)*w,t[10]=(1-(l+h))*w,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function L(t,e,n,r,o){var a=e[0],i=e[1],u=e[2],f=e[3],c=a+a,s=i+i,l=u+u,d=a*c,v=a*s,h=a*l,p=i*s,m=i*l,g=u*l,x=f*c,b=f*s,M=f*l,y=r[0],w=r[1],R=r[2],S=o[0],C=o[1],T=o[2],D=(1-(p+g))*y,E=(v+M)*y,P=(h-b)*y,_=(v-M)*w,j=(1-(d+g))*w,F=(m+x)*w,k=(h+b)*R,A=(m-x)*R,L=(1-(d+p))*R;return t[0]=D,t[1]=E,t[2]=P,t[3]=0,t[4]=_,t[5]=j,t[6]=F,t[7]=0,t[8]=k,t[9]=A,t[10]=L,t[11]=0,t[12]=n[0]+S-(D*S+_*C+k*T),t[13]=n[1]+C-(E*S+j*C+A*T),t[14]=n[2]+T-(P*S+F*C+L*T),t[15]=1,t}function B(t,e){var n=e[0],r=e[1],o=e[2],a=e[3],i=n+n,u=r+r,f=o+o,c=n*i,s=r*i,l=r*u,d=o*i,v=o*u,h=o*f,p=a*i,m=a*u,g=a*f;return t[0]=1-l-h,t[1]=s+g,t[2]=d-m,t[3]=0,t[4]=s-g,t[5]=1-c-h,t[6]=v+p,t[7]=0,t[8]=d+m,t[9]=v-p,t[10]=1-c-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function O(t,e,n,r,o,a,i){var u=1/(n-e),f=1/(o-r),c=1/(a-i);return t[0]=2*a*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*a*f,t[6]=0,t[7]=0,t[8]=(n+e)*u,t[9]=(o+r)*f,t[10]=(i+a)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=i*a*2*c,t[15]=0,t}function U(t,e,n,r,o){var a,i=1/Math.tan(e/2);return t[0]=i/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=o&&o!==1/0?(a=1/(r-o),t[10]=(o+r)*a,t[14]=2*o*r*a):(t[10]=-1,t[14]=-2*r),t}function N(t,e,n,r){var o=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),i=Math.tan(e.leftDegrees*Math.PI/180),u=Math.tan(e.rightDegrees*Math.PI/180),f=2/(i+u),c=2/(o+a);return t[0]=f,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(i-u)*f*.5,t[9]=(o-a)*c*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function I(t,e,n,r,o,a,i){var u=1/(e-n),f=1/(r-o),c=1/(a-i);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*f,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*u,t[13]=(o+r)*f,t[14]=(i+a)*c,t[15]=1,t}function z(t,e,n,r){var a,i,u,f,c,s,d,v,h,p,m=e[0],g=e[1],x=e[2],b=r[0],M=r[1],y=r[2],w=n[0],R=n[1],S=n[2];return Math.abs(m-w)<o&&Math.abs(g-R)<o&&Math.abs(x-S)<o?l(t):(d=m-w,v=g-R,h=x-S,a=M*(h*=p=1/Math.hypot(d,v,h))-y*(v*=p),i=y*(d*=p)-b*h,u=b*v-M*d,(p=Math.hypot(a,i,u))?(a*=p=1/p,i*=p,u*=p):(a=0,i=0,u=0),f=v*u-h*i,c=h*a-d*u,s=d*i-v*a,(p=Math.hypot(f,c,s))?(f*=p=1/p,c*=p,s*=p):(f=0,c=0,s=0),t[0]=a,t[1]=f,t[2]=d,t[3]=0,t[4]=i,t[5]=c,t[6]=v,t[7]=0,t[8]=u,t[9]=s,t[10]=h,t[11]=0,t[12]=-(a*m+i*g+u*x),t[13]=-(f*m+c*g+s*x),t[14]=-(d*m+v*g+h*x),t[15]=1,t)}function V(t,e,n,r){var o=e[0],a=e[1],i=e[2],u=r[0],f=r[1],c=r[2],s=o-n[0],l=a-n[1],d=i-n[2],v=s*s+l*l+d*d;v>0&&(s*=v=1/Math.sqrt(v),l*=v,d*=v);var h=f*d-c*l,p=c*s-u*d,m=u*l-f*s;return(v=h*h+p*p+m*m)>0&&(h*=v=1/Math.sqrt(v),p*=v,m*=v),t[0]=h,t[1]=p,t[2]=m,t[3]=0,t[4]=l*m-d*p,t[5]=d*h-s*m,t[6]=s*p-l*h,t[7]=0,t[8]=s,t[9]=l,t[10]=d,t[11]=0,t[12]=o,t[13]=a,t[14]=i,t[15]=1,t}function G(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function Y(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function W(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function X(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function Q(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function q(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function H(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function Z(t,e){var n=t[0],r=t[1],a=t[2],i=t[3],u=t[4],f=t[5],c=t[6],s=t[7],l=t[8],d=t[9],v=t[10],h=t[11],p=t[12],m=t[13],g=t[14],x=t[15],b=e[0],M=e[1],y=e[2],w=e[3],R=e[4],S=e[5],C=e[6],T=e[7],D=e[8],E=e[9],P=e[10],_=e[11],j=e[12],F=e[13],k=e[14],A=e[15];return Math.abs(n-b)<=o*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(r-M)<=o*Math.max(1,Math.abs(r),Math.abs(M))&&Math.abs(a-y)<=o*Math.max(1,Math.abs(a),Math.abs(y))&&Math.abs(i-w)<=o*Math.max(1,Math.abs(i),Math.abs(w))&&Math.abs(u-R)<=o*Math.max(1,Math.abs(u),Math.abs(R))&&Math.abs(f-S)<=o*Math.max(1,Math.abs(f),Math.abs(S))&&Math.abs(c-C)<=o*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(s-T)<=o*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(l-D)<=o*Math.max(1,Math.abs(l),Math.abs(D))&&Math.abs(d-E)<=o*Math.max(1,Math.abs(d),Math.abs(E))&&Math.abs(v-P)<=o*Math.max(1,Math.abs(v),Math.abs(P))&&Math.abs(h-_)<=o*Math.max(1,Math.abs(h),Math.abs(_))&&Math.abs(p-j)<=o*Math.max(1,Math.abs(p),Math.abs(j))&&Math.abs(m-F)<=o*Math.max(1,Math.abs(m),Math.abs(F))&&Math.abs(g-k)<=o*Math.max(1,Math.abs(g),Math.abs(k))&&Math.abs(x-A)<=o*Math.max(1,Math.abs(x),Math.abs(A))}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var K=m,$=X},function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}},function(t,e){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return u}));for(var r=n(3),o=new Array(200),a=0,i=o.length;a<i;a++)o[a]=1-2*Math.random();var u=function(t,e){if(e<=t[0][0])return t[0][1];if(e>=t[t.length-1][0])return t[t.length-1][1];for(var n=0;n<t.length-1;n++)if(e>=t[n][0]&&e<t[n+1][0])return r.a.mix(t[n][1],t[n+1][1],r.a.inverseMix(t[n][0],t[n+1][0],e))}},function(t,e,n){var r=n(8);t.exports=function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}},function(t,e,n){var r=n(8);t.exports=function(t){if(Array.isArray(t))return r(t)}},function(t,e){t.exports=function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},,,,,,function(t,e,n){"use strict";n.d(e,"c",(function(){return u})),n.d(e,"b",(function(){return f})),n.d(e,"a",(function(){return c}));var r=n(2),o=n.n(r),a=n(0),i=n(1),u=function(t){var e=[[-1,-1],[-1,1],[1,-1],[1,1]].flat(),n=Object(a.a)(t,e,2),r=[[0,0],[0,1],[1,0],[1,1]].flat(),o=Object(a.a)(t,r,2),i=[[1,2,0],[1,3,2]].flat();return{positionBufferData:n,textureCoordinatesBufferData:o,indicesBufferData:Object(a.d)(t,i,Uint8Array)}},f=function(t,e,n){var r,u,f=e.points,c=e.section,s=e.length,l=[],d=[],v=[],h=.5*n,p=function(t,e,n){return[i.b.add(t,i.b.scale(e,-n)),i.b.add(t,i.b.scale(e,n))]};r=f[0],u=i.b.add(r.p,i.b.scale(r.t,-h)),l.push.apply(l,o()(p(u,r.n,h))),f.forEach((function(t){var e=p(t.p,t.n,h);l.push.apply(l,o()(e))})),r=f[f.length-1],u=i.b.add(r.p,i.b.scale(r.t,h)),l.push.apply(l,o()(p(u,r.n,h)));var m=[h].concat(o()(c),[h]),g=n+s,x=m.map((function(t){return t/g}));d.push([0,0],[0,1]);var b=0;x.forEach((function(t){b+=t,d.push([b,0],[b,1])}));for(var M=0;M<f.length+2-1;M++)v.push([1+2*M,2+2*M,0+2*M],[1+2*M,3+2*M,2+2*M]);return{positionBufferData:Object(a.a)(t,l.flat(),2),textureCoordinatesBufferData:Object(a.a)(t,d.flat(),2),indicesBufferData:Object(a.d)(t,v.flat(),Uint8Array)}},c=function(t){var e=[[0,0],[0,1],[1,0],[1,1]].flat(),n=Object(a.a)(t,e,2),r=[[0,0],[0,1],[1,0],[1,1]].flat(),o=Object(a.a)(t,r,2),i=[[1,2,0],[1,3,2]].flat();return{positionBufferData:n,textureCoordinatesBufferData:o,indicesBufferData:Object(a.d)(t,i)}}},,,,,,,,,,function(t,e,n){"use strict";e.a={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return t*(2-t)},easeInOutQuad:function(t){return t<.5?2*t*t:(4-2*t)*t-1},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return--t*t*t+1},easeInOutCubic:function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return 1- --t*t*t*t},easeInOutQuart:function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return 1+--t*t*t*t*t},easeInOutQuint:function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t}}},,,,,,,function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(1),o=n(3),a=function(t,e){0!=e[0]&&(t[0]=t[0]%e[0]),0!=e[1]&&(t[1]=t[1]%e[1]);var n=r.b.dot(t,[127.1,311.7]);return 2*o.a.fract(43758.5453123*Math.sin(n))-1},i=function(t,e){var n=r.b.floor(t),i=r.b.fract(t),u=r.b.mul(r.b.mul(i,i),r.b.sub([3,3],r.b.scale(i,2))),f=a(n,e),c=a(r.b.add(n,[1,0]),e),s=a(r.b.add(n,[0,1]),e),l=a(r.b.add(n,[1,1]),e);return o.a.mix(o.a.mix(f,c,u[0]),o.a.mix(s,l,u[0]),u[1])}},function(t,e,n){var r=n(39),o=n(40),a=n(11),i=n(41);t.exports=function(t,e){return r(t)||o(t,e)||a(t,e)||i()}},function(t,e){t.exports=function(t){if(Array.isArray(t))return t}},function(t,e){t.exports=function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,o=!1,a=void 0;try{for(var i,u=t[Symbol.iterator]();!(r=(i=u.next()).done)&&(n.push(i.value),!e||n.length!==e);r=!0);}catch(t){o=!0,a=t}finally{try{r||null==u.return||u.return()}finally{if(o)throw a}}return n}}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e){t.exports="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat4 uProjectionMatrix;\nvarying highp vec2 vTextureCoord;\nuniform float uFlipY;\nvoid main(void){\n  vTextureCoord=(aTextureCoord-vec2(0.5,0.5))*vec2(1.0,uFlipY)+vec2(0.5,0.5);\n  // gl_Position=uProjectionMatrix*vec4((2.*aVertexPosition+vec2(-1.,-1.))*vec2(1.,uFlipY),0.,1.);\n  gl_Position=uProjectionMatrix*vec4(aVertexPosition,0.,1.);\n}"},function(t,e){t.exports="precision highp float;\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nvoid main()\n{\n  vec4 color = texture2D(uSampler,vTextureCoord);\n  // if(vTextureCoord.x<=0.1 || vTextureCoord.y<=0.1){\n  //   color = vec4(1.0,0.0,0.0,1.0);\n  // }\n  gl_FragColor=color;\n}\n"},function(t,e){t.exports="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat4 uProjectionMatrix;\nvarying highp vec2 vTextureCoord;\nuniform float uFlipY;\nvoid main(void){\n  vTextureCoord=(aTextureCoord-vec2(0.5,0.5))*vec2(1.0,uFlipY)+vec2(0.5,0.5);\n  // gl_Position=uProjectionMatrix*vec4((2.*aVertexPosition+vec2(-1.,-1.))*vec2(1.,uFlipY),0.,1.);\n  gl_Position=uProjectionMatrix*vec4(aVertexPosition,0.,1.);\n}"},function(t,e){t.exports="precision highp float;\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform lowp vec2 uSize;\nuniform vec2 uDir;\nuniform float uWidth;\nconst float pi=3.14159265359;\nvoid main()\n{\n  vec4 colorSum=vec4(0.);\n  const int N=50;\n  float count = 0.;\n  for(int k=0;k<=N;k++){\n    float _k = float(k);\n    if(_k>uWidth)break;\n    float val=cos((_k/min(uWidth,float(N)))*pi*0.5);\n    vec2 offset = _k*uDir/uSize;\n    colorSum+=val*texture2D(uSampler,vTextureCoord-offset);\n    colorSum+=val*texture2D(uSampler,vTextureCoord+offset);\n    count+=val*2.;\n  }\n  colorSum/=count;\n  gl_FragColor=colorSum;\n}\n"},function(t,e){t.exports="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform vec2 uSize;\nvarying vec2 vTextureCoord;\nvarying vec2 vSize;\nvoid main(void){\n  vSize=uSize;\n  vTextureCoord=aTextureCoord;\n  vec4 pos=uModelViewMatrix*vec4(aVertexPosition*uSize*.5,0.,1.);\n  gl_Position=uProjectionMatrix*pos;\n}"},function(t,e){t.exports="precision highp float;\nuniform bool uWireframe;\nvarying vec2 vTextureCoord;\nvarying vec2 vSize;\nuniform sampler2D uGradientColorSampler;\n\nfloat distLine(vec2 p,vec2 a,vec2 b,float w){\n  vec2 pa=p-a;\n  vec2 ba=b-a;\n  float t=clamp(dot(pa,ba)/dot(ba,ba),0.,1.);\n  return length(pa-ba*t)/w;\n}\n\n/*vec4 drawLight(float d){\n  float highColorRate=smoothstep(1.,0.,d);\n  float baseColorRate=smoothstep(1.,0.,d/4.);\n  float glowColorRate=smoothstep(1.,0.,d/8.);\n  float endColorRate=smoothstep(1.,0.,d/16.);\n  vec4 highColor=vec4(1.,1.,1.,1.);\n  vec4 baseColor=vec4(.35,.98,.98,1.);\n  vec4 glowColor=vec4(.28,.73,.78,1.);\n  vec4 endColor=vec4(.2,.25,.91,1.);\n  vec4 color=mix(.5*baseColor,highColor,highColorRate)*endColorRate;\n  color=mix(.25*glowColor,color,baseColorRate)*endColorRate;\n  color=mix(.125*endColor,color,glowColorRate)*endColorRate;\n  return color;\n}\nvec4 distLightLine(vec2 p,vec2 a,vec2 b,float w){\n  float d=distLine(p,a,b,w);\n  return drawLight(d);\n}*/\n\nfloat drawLight(float d,float power){\n  float f=1.;\n  float a=1.;\n  const int N=3;\n  float maxF=pow(2.,float(N));\n  for(int i=0;i<N;i++){\n    a*=.5;\n    float colorRate=smoothstep(1.,0.,2.*a*d);\n    float rate=pow(colorRate,a*maxF);\n    f=mix(a,f,rate);\n  }\n  f*=power*smoothstep(1.,0.,d/maxF);\n  return f;\n}\nvec4 distLightPoint(float d,float power,sampler2D gradientColorSampler){\n  float f=drawLight(d,power);\n  return vec4(f*texture2D(gradientColorSampler,vec2(f,0.)));\n}\nvec4 distLightLine(vec2 p,vec2 a,vec2 b,float w,float power,sampler2D gradientColorSampler){\n  float d=distLine(p,a,b,w);\n  float f=drawLight(d,power);\n  return vec4(f*texture2D(gradientColorSampler,vec2(f,0.)));\n}\n\nvoid main(void){\n  vec4 color=vec4(0.);\n  if(uWireframe){\n    vec2 lineWidth=1./vSize;\n    if(vTextureCoord.x<lineWidth.x||vTextureCoord.x>1.-lineWidth.x||vTextureCoord.y<lineWidth.y||vTextureCoord.y>1.-lineWidth.y){\n      color+=.5*vec4(1.,0.,0.,1.);\n    }\n  }\n  vec2 aspectRatio=vec2(vSize.x/vSize.y,1.);\n  \n  vec2 coord=vTextureCoord*aspectRatio;\n  vec2 startPos=vec2(0.,.5)*aspectRatio+vec2(aspectRatio.y*.5,0.);\n  vec2 endPos=vec2(1.,.5)*aspectRatio-vec2(aspectRatio.y*.5,0.);\n  float r=aspectRatio.y*.5/8.;\n  color+=distLightLine(coord,startPos,endPos,r,1.,uGradientColorSampler);\n  gl_FragColor=color;\n}"},function(t,e){t.exports="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat4 uProjectionMatrix;\nvarying highp vec2 vTextureCoord;\nuniform float uFlipY;\nvoid main(void){\n  vTextureCoord=(aTextureCoord-vec2(0.5,0.5))*vec2(1.0,uFlipY)+vec2(0.5,0.5);\n  // gl_Position=uProjectionMatrix*vec4((2.*aVertexPosition+vec2(-1.,-1.))*vec2(1.,uFlipY),0.,1.);\n  gl_Position=uProjectionMatrix*vec4(aVertexPosition,0.,1.);\n}"},function(t,e){t.exports="precision highp float;\nvarying vec2 vTextureCoord;\nuniform sampler2D uGlowSampler;\nuniform sampler2D uSampler;\nuniform lowp vec2 uSize;\nuniform float uTime;\nconst float pi=3.14159265359;\nconst int OCTAVE_NUM=3;\nvec2 random2(vec2 p,vec2 loop){\n  if(loop.x!=0.){\n    p.x=mod(p.x,loop.x);\n  }\n  if(loop.y!=0.){\n    p.y=mod(p.y,loop.y);\n  }\n  vec2 f=vec2(\n    dot(p,vec2(1.271,3.117)),\n    dot(p,vec2(2.695,1.833))\n  );\n  return-1.+2.*fract(sin(f)*437.585453123);\n}\n\nfloat noise_perlin(vec2 p,vec2 loop){\n  vec2 i=floor(p);\n  vec2 f=fract(p);\n  float a=dot(random2(i,loop),f);\n  float b=dot(random2(i+vec2(1.,0.),loop),f-vec2(1.,0.));\n  float c=dot(random2(i+vec2(0.,1.),loop),f-vec2(0.,1.));\n  float d=dot(random2(i+vec2(1.,1.),loop),f-vec2(1.,1.));\n  //vec2 u=smoothstep(0.,1.,f);\n  vec2 u=f*f*(3.-2.*f);\n  return mix(mix(a,b,u.x),mix(c,d,u.x),u.y);\n}\n\nfloat fbm_noise_perlin(vec2 p,vec2 loop){\n  float f=0.;\n  float a=.5;\n  for(int i=0;i<OCTAVE_NUM;i++)\n  {\n    f+=a*noise_perlin(p,loop);\n    p*=2.;\n    a/=2.;\n  }\n  return f;\n}\nfloat fbm_abs_noise_perlin(vec2 p,vec2 loop){\n  float f=0.;\n  float a=.5;\n  for(int i=0;i<OCTAVE_NUM;i++)\n  {\n    f+=a*abs(noise_perlin(p,loop));\n    p*=2.;\n    a/=2.;\n  }\n  return f;\n}\nvoid main()\n{\n  vec4 diff = vec4(0.0);\n  const int n = 5;\n  for(int i=-n;i<=n;i++){\n    vec4 centerColor = texture2D(uSampler, vTextureCoord+vec2(float(i),0.) / uSize);\n    vec4 leftColor = texture2D(uSampler, vTextureCoord+vec2(float(i),0.) / uSize-vec2(1.,0.) / uSize);\n    float rate = abs((1.-abs(float(i)/float(n))));\n    diff+=abs(centerColor-leftColor)*pow(rate,1.5);\n  }\n  for(int i=-n;i<=n;i++){\n    vec4 centerColor = texture2D(uSampler, vTextureCoord+vec2(0.,float(i)) / uSize);\n    vec4 topColor = texture2D(uSampler, vTextureCoord+vec2(0.,float(i)) / uSize-vec2(0.,1.) / uSize);\n    float rate = abs((1.-abs(float(i)/float(n))));\n    diff+=abs(centerColor-topColor)*pow(rate,1.5);\n  }\n  float power = (cos(uTime*pi)+1.)*0.5;\n  float f=fbm_noise_perlin(vTextureCoord*20.+vec2(0.,-20.*fract(uTime*0.01)),vec2(20.,20.))*.5+.5;\n  float f1=fbm_abs_noise_perlin(vTextureCoord*10.,vec2(10.,10.))*.5+.5;\n  vec4 glowColor = texture2D(uGlowSampler,vTextureCoord);\n  vec4 color = texture2D(uSampler,vTextureCoord);\n  vec4 outColor = 0.5*(cos(f*40.+uTime*0.1)+1.)*vec4(diff.rgb,1.)*vec4(0.4,0.7,1.,1.);\n  float f0 =pow((glowColor.r + glowColor.g + glowColor.b)/3.,0.5);\n  vec4 _glowColor = glowColor*((1.-f0)*vec4(0.3,0.8,0.9,1.)+f0*vec4(0.8,0.8,1.,1.));\n  //gl_FragColor = color+outColor+_glowColor;\n  //gl_FragColor = vec4(vec3(f2),1.);\n  vec4 c = texture2D(uSampler, vTextureCoord);\n  vec4 t = texture2D(uSampler, vTextureCoord-vec2(0.,1.) / uSize);\n  vec4 diff0 = c-t;\n  float a = (diff0.r + diff0.g + diff0.b)/3.;\n  float f2=fbm_noise_perlin(vTextureCoord*30.+vec2(0.,-30.*fract(uTime*0.05)*(0.5+_glowColor.r*0.5)),vec2(30.,30.))*.5+.5;\n  gl_FragColor = color+outColor+_glowColor*f2*3.;\n  //gl_FragColor = 2.*outColor;\n}\n"},function(t,e){t.exports="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat4 uProjectionMatrix;\nuniform float uLength;\nuniform vec2 uThickness;\nuniform vec2 uRadius;\nuniform float uExpand;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vSize;\nvarying vec2 vDir;\nvarying vec2 vRadius;\nvarying vec2 vThickness;\nvarying float vOffset;\nconst float pi=3.14159265359;\nmat2 rotCoord(float a){\n  float sin_factor=sin(a);\n  float cos_factor=cos(a);\n  mat2 rot=mat2(cos_factor,sin_factor,-sin_factor,cos_factor);\n  return rot;\n}\nvec2 getQuadraticCurveTo(vec2 p0,vec2 p1,vec2 p2,float t){\n  return p0*(1.-t)*(1.-t)+p1*2.*(1.-t)*t+p2*t*t;\n}\nvec2 getQuadraticCurveToTangent(vec2 p0,vec2 p1,vec2 p2,float t){\n  return 2.*t*(p0-p1*2.+p2)+2.*(-p0+p1);\n}\nvoid main(void){\n  vRadius=uRadius;\n  vThickness=uThickness;\n  vSize=vec2(uLength,0.)+vec2(uExpand);\n  vTextureCoord=aTextureCoord;\n  vDir=vec2(1.0,0.0);\n  gl_Position=uProjectionMatrix*vec4(aVertexPosition,0.,1.);\n}\n\n"},function(t,e){t.exports="precision highp float;\nprecision highp sampler2D;\nvarying vec2 vTextureCoord;\nvarying vec2 vSize;\nvarying vec2 vDir;\nvarying vec2 vRadius;\nvarying vec2 vThickness;\n\nuniform sampler2D uNoiseSampler;\nuniform sampler2D uGradientColorSampler;\nuniform sampler2D uThicknessScaleSampler;\nuniform float uGradientColorRate;\nuniform float uThicknessScaleRate;\nuniform float uTime;\nuniform vec2 uDensity;\nuniform vec2 uFixed;\nuniform float uPower;\nuniform vec2 uBorderPower;\n\nuniform bool uSub;\n\nuniform bool uFlow;\nuniform float uFlowRate;\n\nuniform bool uWireframe;\n\nconst float pi=3.14159265359;\n\nfloat gradual(vec2 p,vec2 a,vec2 b){\n  vec2 pa=p-a;\n  vec2 ba=b-a;\n  return clamp(dot(pa,ba)/dot(ba,ba),0.,1.);\n}\nfloat distLine(vec2 p,vec2 a,vec2 b,float w){\n  vec2 pa=p-a;\n  vec2 ba=b-a;\n  float t=clamp(dot(pa,ba)/dot(ba,ba),0.,1.);\n  return length(pa-ba*t)/w;\n}\nfloat drawLight(float d,float power){\n  float f=1.;\n  float a=1.;\n  const int N=3;\n  float maxF=pow(2.,float(N));\n  for(int i=0;i<N;i++){\n    a*=.5;\n    float colorRate=smoothstep(1.,0.,2.*a*d);\n    float rate=pow(colorRate,a*maxF);\n    f=mix(a,f,rate);\n  }\n  f*=power*smoothstep(1.,0.,d/maxF);\n  return f;\n}\nvec4 distLightPoint(vec2 p,vec2 a,float w,float power,sampler2D gradientColorSampler,float gradientColorRate){\n  float d=length(p-a)/w;\n  float f=drawLight(d,power);\n  return vec4(f*texture2D(gradientColorSampler,vec2(f,gradientColorRate)));\n}\nvec4 distLightLine(vec2 p,vec2 a,vec2 b,float w,float power,sampler2D gradientColorSampler,float gradientColorRate){\n  float d=distLine(p,a,b,w);\n  float f=drawLight(d,power);\n  return vec4(f*texture2D(gradientColorSampler,vec2(f,gradientColorRate)));\n}\nmat2 rotCoord(float a){\n  float sin_factor=sin(a);\n  float cos_factor=cos(a);\n  mat2 rot=mat2(cos_factor,sin_factor,-sin_factor,cos_factor);\n  return rot;\n}\nvec3 getNoise(sampler2D sampler,vec2 uv,float time,float startDensity,float endDensity){\n  float ff=abs(texture2D(sampler,fract((uv+vec2(-time,-time)))*.001).r*2.-1.);\n  \n  vec2 uv0x=fract((uv+vec2(-time,0.))*startDensity);\n  vec2 uv1x=fract((uv+vec2(-time,0.))*endDensity);\n  vec2 uv0y=fract((uv+vec2(0.,-time))*startDensity);\n  vec2 uv1y=fract((uv+vec2(0.,-time))*endDensity);\n  \n  float f0=(.5*(texture2D(sampler,uv0x).r+texture2D(sampler,uv0y).g)*2.-1.)*2.*pi;\n  float f1=(.5*(texture2D(sampler,uv1x).r+texture2D(sampler,uv1y).g)*2.-1.)*2.*pi;\n  return vec3(f0,f1,ff);\n}\n\nvec2 getMove(float gradualVal,vec2 dir,float startRadius,float endRadius,float startFixed,float endFixed,vec3 noise){\n  float swing=sin(gradualVal*pi);\n  swing=1.-pow(1.-swing,2.);\n  float a=atan(dir.y,dir.x);\n  vec2 move0=startRadius*mix(1.-startFixed,1.,swing)*vec2(cos(noise.x),sin(noise.x))*rotCoord(a);\n  vec2 move1=endRadius*mix(1.-endFixed,1.,swing)*vec2(cos(noise.y),sin(noise.y))*rotCoord(a);\n  return noise.z*mix(move0,move1,gradualVal);\n}\nvec2 getQuadraticCurveTo(vec2 p0,vec2 p1,vec2 p2,float t){\n  return p0*(1.-t)*(1.-t)+p1*2.*(1.-t)*t+p2*t*t;\n}\nvec2 getQuadraticCurveToTangent(vec2 p0,vec2 p1,vec2 p2,float t){\n  return 2.*t*(p0-p1*2.+p2)+2.*(-p0+p1);\n}\nfloat toRate(float x){\n  //sigmoid\n  return 1.0/(1.0+exp(1.0*(-x*4.0+7.0)))+1.0/(1.0+exp(-2.0*(-x*4.0+17.0)))-1.0;\n}\nvoid main(void){\n  vec4 color=vec4(0.);\n  \n  vec2 aspectRatio=vec2(vSize.x/vSize.y,1.);\n  vec2 coord=vTextureCoord*aspectRatio;\n  vec2 startPos=(vec2(0.,.5)*aspectRatio+vec2(.5,0.));\n  vec2 endPos=(vec2(1.,.5)*aspectRatio-vec2(.5,0.));\n  float startR=vThickness.x/vSize.y;\n  float endR=vThickness.y/vSize.y;\n  float power=pow(uPower,.5);\n  \n  vec3 noise=getNoise(uNoiseSampler,gl_FragCoord.xy*.003,uTime,uDensity.x*.5,uDensity.y*.5);\n  \n  float gradualVal=smoothstep(startPos.x,endPos.x,coord.x);\n  vec4 thicknessScale=texture2D(uThicknessScaleSampler,vec2(gradualVal,uThicknessScaleRate));\n  {\n    //主電流\n    vec2 move=getMove(gradualVal,vDir,vRadius.x,vRadius.y,uFixed.x,uFixed.y,noise)/vSize.y;\n    coord+=move;\n\n\n    {\n        // vec2 coord=vTextureCoord*aspectRatio;\n        //光球\n      color+=distLightPoint(coord,startPos,startR,1.,uGradientColorSampler,uGradientColorRate)*uBorderPower.x*0.5;\n      color+=distLightPoint(coord,endPos,endR,1.,uGradientColorSampler,uGradientColorRate)*uBorderPower.y*0.5;\n    }\n    \n    float r=mix(startR,endR,gradualVal)*power;\n    \n    //r*=(1.-1.*sin(gradualVal*pi));\n    r*=thicknessScale.r;\n    color+=distLightLine(coord,startPos,endPos,r,power,uGradientColorSampler,uGradientColorRate);\n  }\n  {\n    //子電流\n    if(uSub){\n      for(int i=0;i<2;i++){\n        vec3 noise0=getNoise(uNoiseSampler,gl_FragCoord.xy*.001,uTime*.75+float(i+1)*noise.z,max(uDensity.x*.5,.3),max(uDensity.y*.5,.3));\n        float startPosRate=cos(noise0.x)*.5+.5;\n        float endPosRate=sin(noise0.y)*.5+.5;\n        vec2 startPos0=mix(startPos,endPos,startPosRate);\n        vec2 endPos0=mix(startPos,endPos,endPosRate);\n        float gradualVal0=smoothstep(startPos0.x,endPos0.x,coord.x);\n        vec2 move0=1.2*sin(gradualVal0*pi)*getMove(gradualVal0,vDir,vRadius.x*.5+vThickness.x,vRadius.y*.5+vThickness.y,1.,1.,noise0)/vSize.y;\n        float r0=mix(mix(startR,endR,startPosRate),mix(startR,endR,endPosRate),gradualVal0)*.5*power;\n        r0*=1.-.5*sin(gradualVal0*pi);\n        color+=min(thicknessScale.r+.2,1.)*distLightLine(coord+move0,startPos0,endPos0,r0,power,uGradientColorSampler,uGradientColorRate);\n      }\n    }\n  }\n  {\n    //流動\n    if(uFlow){\n      float rate=mix(5.,0.,uFlowRate);\n      float gradualVal00=toRate(gradualVal+rate);\n      color*=gradualVal00;\n    }\n    \n  }\n  \n  //color=texture2D(uGradientColorSampler,vTextureCoord);\n  \n  if(uWireframe){\n    vec2 lineWidth=5./vSize;\n    if(vTextureCoord.x<lineWidth.x||vTextureCoord.x>1.-lineWidth.x||vTextureCoord.y<lineWidth.y||vTextureCoord.y>1.-lineWidth.y){\n      //color+=.5*vec4(1.,0.,0.,1.);\n      color=vec4(1.,0.,0.,1.);\n    }\n  }\n  //color+=distLightLine(coord,mix(startPos,endPos,.5),mix(startPos,endPos,.5)+vec2(0.,.2),.01,1.5);\n  \n  gl_FragColor=color;\n  //gl_FragColor=vec4(0.0,1.0,0.0,1.0);\n}"},,,,,,,,,,function(t,e,n){"use strict";n.r(e);var r=n(38),o=n.n(r),a=n(2),i=n.n(a),u=n(7),f=n(9),c=n.n(f),s=n(4),l=n.n(s),d=n(5),v=n.n(d),h=n(20),p=n(10),m=n(1),g=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};l()(this,t),this.curveInfo=n,this.fun=null,this.id=Date.now()+"_"+Math.floor(1e5*Math.random()),this.options={group:"",pointList:[],t:1,tMax:2,randomSeed:1e3*Math.random(),flow:!1,removeState:!1,remove:!1,expand:150,n:30,density:[.2,.4],thickness:[5,3],borderPower:[6,4],sub:!0,radius:[20,20],power:1},Object.assign(this.options,r),this.gradientColorRateData=[[0,1],[.1,1],[.25,0],[.75,0],[.9,1],[1,1]],this.thicknessScaleRateData=[[0,2],[.1,0],[.25,0],[.75,0],[.9,0],[1,2]],this.powerData=[[0,0],[.1,0],[.2,.75],[.35,2],[.65,1.5],[.8,.75],[.9,0],[1,0]],this.flowRateData=[[0,0],[.1,0],[.3,.5],[.7,.5],[.9,1],[1,1]]}return v()(t,[{key:"onUpdate",value:function(t){this.fun=t}},{key:"update",value:function(t){this.fun&&this.fun(this,t),this.options.flow&&(this.options.removeState?this.tRate<1?this.options.t+=t:this.options.remove=!0:this.tRate<.5&&(this.options.t+=t))}},{key:"removeBefore",value:function(t){}},{key:"getBufferData",value:function(t){var e=this.options,n=e.expand,r=e.n,o=this.curveInfo.apply(this,i()(this.options.pointList).concat([r]));return{bufferData:Object(h.b)(t,o,n),length:o.length}}},{key:"draw",value:function(t,e,n){var r,o={now:0};Object.assign(o,n);var a=this.options,i=a.textures,u=a.expand,f=a.randomSeed,s=a.thickness,l=a.borderPower,d=a.density,v=a.sub,h=a.radius,m=a.power,g=this.options.shader;g.use();var x=this.getBufferData(t),b=x.bufferData,M=x.length;g.attribSet({vertexPosition:b.positionBufferData.buffer,textureCoord:b.textureCoordinatesBufferData.buffer}),g.elementSet(b.indicesBufferData.buffer);var y=this.tRate;g.uniformSet((r={projectionMatrix:e,wireframe:!1,noiseSampler:i.noise,gradientColorSampler:i.gradientColor,thicknessScaleSampler:i.thicknessScale,sub:v,time:.001*o.now+f,expand:u,density:d,fixed:[1,1],radius:h,thickness:s,borderPower:l,length:M,power:1},c()(r,"power",m*Object(p.a)(this.powerData,y)),c()(r,"gradientColorRate",0),c()(r,"gradientColorRate",Object(p.a)(this.gradientColorRateData,y)),c()(r,"thicknessScaleRate",0),c()(r,"thicknessScaleRate",Object(p.a)(this.thicknessScaleRateData,y)),c()(r,"flow",this.options.flow),c()(r,"flowRate",Object(p.a)(this.flowRateData,y)),r)),g.draw(b.indicesBufferData.length)}},{key:"remove",value:function(){this.options.removeState=!0}},{key:"group",get:function(){return this.options.group}},{key:"removeState",get:function(){return this.options.removeState}},{key:"confirmRemove",get:function(){return this.options.remove}},{key:"tRate",get:function(){return this.options.t/this.options.tMax}},{key:"radius",set:function(t){m.c.set.apply(m.c,[this.options.radius].concat(i()(t)))}},{key:"power",set:function(t){this.options.power=t}}]),t}();n(37),n(3);CanvasRenderingContext2D.prototype.fillTextWithSpacing=function(t,e,n){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=e,a=0;a<t.length;a++){this.fillText(t[a],o,n);var i=this.measureText(t[a]);o+=i.actualBoundingBoxRight+i.actualBoundingBoxLeft+r}},CanvasRenderingContext2D.prototype.strokeTextWithSpacing=function(t,e,n){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=e,a=0;a<t.length;a++){this.strokeText(t[a],o,n);var i=this.measureText(t[a]);o+=i.actualBoundingBoxRight+i.actualBoundingBoxLeft+r}};var x=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;t.textAlign="start",t.textBaseline="hanging",t.font=n;var o={pos:[0,0],size:[0,0]};if(0===e.length)return o;var a=0,i=t.measureText(e[0]);o.pos[0]=i.actualBoundingBoxLeft,o.pos[1]=i.actualBoundingBoxAscent,o.size[1]=i.actualBoundingBoxDescent+i.actualBoundingBoxAscent,a+=i.actualBoundingBoxRight+i.actualBoundingBoxLeft;for(var u=1;u<e.length;u++)a+=(i=t.measureText(e[u])).actualBoundingBoxRight+i.actualBoundingBoxLeft+r;return o.size[0]=a,o},b=n(0),M=n(67),y=n.n(M),w=n(68),R=n.n(w),S=function(t,e,n){var r=Object(b.g)(t,e,n);return{program:r,attribLocations:{vertexPosition:b.b.attribFloat(t,r,"aVertexPosition",2),textureCoord:b.b.attribFloat(t,r,"aTextureCoord",2)},uniformLocations:{projectionMatrix:b.j.uniformMatrix4fv(t,r,"uProjectionMatrix"),flipY:b.j.uniform1f(t,r,"uFlipY"),sampler:b.j.uniformTexture(t,r,"uSampler",0)}}},C=function(t){return Object.assign(Object(b.i)(t,S,y.a,R.a),{draw:function(e){t.drawElements(t.TRIANGLES,e,t.UNSIGNED_BYTE,0)}})},T=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};l()(this,t),this.shader=C(e),this.text="",this.pos=[0,0],this.width=0,this.height=0,this.texture=null,this.bufferData=null,this.options={},Object.assign(this.options,n)}return v()(t,[{key:"setText",value:function(t,e,n){this.text=e;var r=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;if(!(t.length<=0)){var o=document.createElement("canvas"),a=o.getContext("2d"),i=x(a,t,e,r),u=i.pos,f=i.size;o.width=f[0]+2*n,o.height=f[1]+2*n,a.textAlign="start",a.textBaseline="hanging",a.font=e,a.clearRect(0,0,o.width,o.height),a.fillStyle="#ffffff",a.strokeStyle="#3f7fff",a.lineWidth=1,a.globalAlpha=.75,a.fillTextWithSpacing(t,u[0]+n,u[1]+n,r),a.globalAlpha=.5,a.strokeTextWithSpacing(t,u[0]+n,u[1]+n,r);var c=o.toDataURL();return{width:o.width,height:o.height,textureData:c}}}(e,n),o=r.width,a=r.height,i=r.textureData;this.width=o,this.height=a,this.texture=Object(b.h)(t,i),this.bufferData=Object(h.a)(t)}},{key:"onUpdate",value:function(t){this.fun=t}},{key:"update",value:function(t){this.fun&&this.fun(this,t)}},{key:"draw",value:function(t,e,n){var r=n&&n.framebufferTexture;r&&Object(b.k)(t,n.framebufferTexture);var o=this.bufferData,a=this.shader;a.use(),a.attribSet({vertexPosition:o.positionBufferData.buffer,textureCoord:o.textureCoordinatesBufferData.buffer}),o.positionBufferData.set(Object(b.f)([].concat(i()(this.pos),i()(m.b.add(this.pos,[this.width,this.height]))))),a.uniformSet({projectionMatrix:e,sampler:this.texture,flipY:r?-1:1}),a.draw(o.indicesBufferData.length),r&&Object(b.k)(t,null,!1)}}]),t}(),D=n(69),E=n.n(D),P=n(70),_=n.n(P),j=function(t,e,n){var r=Object(b.g)(t,e,n);return{program:r,attribLocations:{vertexPosition:b.b.attribFloat(t,r,"aVertexPosition",2),textureCoord:b.b.attribFloat(t,r,"aTextureCoord",2)},uniformLocations:{projectionMatrix:b.j.uniformMatrix4fv(t,r,"uProjectionMatrix"),flipY:b.j.uniform1f(t,r,"uFlipY"),sampler:b.j.uniformTexture(t,r,"uSampler",0),size:b.j.uniform2fv(t,r,"uSize"),dir:b.j.uniform2fv(t,r,"uDir"),width:b.j.uniform1f(t,r,"uWidth")}}},F=function(t){return Object.assign(Object(b.i)(t,j,E.a,_.a),{draw:function(e){t.drawElements(t.TRIANGLES,e,t.UNSIGNED_BYTE,0)}})},k=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};l()(this,t),this.temp=Object(b.c)(e),this.options={},Object.assign(this.options,n)}return v()(t,[{key:"draw",value:function(t,e,n){Object(b.k)(t,this.temp);var r=this.options.bufferData,o=this.options.shader;o.use(),o.attribSet({vertexPosition:r.positionBufferData.buffer,textureCoord:r.textureCoordinatesBufferData.buffer}),r.positionBufferData.set(Object(b.f)([].concat(i()(n.pos),i()(m.b.add(n.pos,[n.width,n.height]))))),o.uniformSet({projectionMatrix:e,sampler:n.texture,flipY:-1,size:[n.width,n.height],dir:[1,0],width:20}),o.draw(r.indicesBufferData.length),Object(b.k)(t,null,!1);var a=n&&n.framebufferTexture;a&&Object(b.k)(t,n.framebufferTexture),o.uniformSet({sampler:this.temp.texture,flipY:a?-1:1,dir:[0,1]}),o.draw(r.indicesBufferData.length),a&&Object(b.k)(t,null,!1)}}]),t}(),A=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};l()(this,t),this.options={},Object.assign(this.options,n)}return v()(t,[{key:"draw",value:function(t,e,n){var r={now:0};Object.assign(r,n);var o=this.options.bufferData,a=this.options.shader;a.use(),a.attribSet({vertexPosition:o.positionBufferData.buffer,textureCoord:o.textureCoordinatesBufferData.buffer}),o.positionBufferData.set(Object(b.f)([].concat(i()(n.pos),i()(m.b.add(n.pos,[n.width,n.height]))))),a.uniformSet({projectionMatrix:e,glowSampler:n.glowTexture,sampler:n.texture,flipY:1,size:[n.width,n.height],time:.001*r.now}),a.draw(o.indicesBufferData.length)}}]),t}(),L=n(30),B=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};l()(this,t),this.options={pos:[0,0],velocity:10,direct:0,lifespan:25,thickness:3,friction:.94,gravity:[0,.981],colorStart:[1,0,0,1],colorEnd:[1,1,0,1]},Object.assign(this.options,n),this.options.pos=m.b.clone(this.options.pos),this.options.prevPos=m.b.clone(this.options.pos),this.options.maxlife=this.options.lifespan,this.options.swing=Math.random(),this.options.velocityPos=[Math.cos(this.options.direct)*this.options.velocity,Math.sin(this.options.direct)*this.options.velocity],this.options.modelViewMatrix=u.a.create()}return v()(t,[{key:"update",value:function(t){m.c.set.apply(m.c,[this.options.prevPos].concat(i()(this.options.pos))),m.c.add(this.options.pos,this.options.velocityPos);var e=[0,Math.sin(2*this.options.swing*Math.PI)];m.c.rotate(e,m.b.getAngle(this.options.velocityPos)),m.c.scale(e,this.options.lifespan/this.options.maxlife),m.c.add(this.options.velocityPos,e),m.c.add(this.options.velocityPos,m.b.add(this.options.gravity,[0,-.6])),m.c.scale(this.options.velocityPos,this.options.friction),this.options.swing+=.1,this.options.swing%=1;var n=this.options.prevPos,r=this.options.pos,o=m.b.sub(r,n),a=m.b.getAngle(o);u.a.identity(this.options.modelViewMatrix),u.a.translate(this.options.modelViewMatrix,this.options.modelViewMatrix,[].concat(i()(m.b.mix(n,r,.5)),[0])),u.a.rotateZ(this.options.modelViewMatrix,this.options.modelViewMatrix,a),this.options.lifespan>0&&(this.options.lifespan-=t)}},{key:"draw",value:function(t,e,n){var r=this.options.bufferData,o=this.options.shader;o.use(),o.attribSet({vertexPosition:r.positionBufferData.buffer,textureCoord:r.textureCoordinatesBufferData.buffer}),o.elementSet(r.indicesBufferData.buffer),o.uniformSet({projectionMatrix:e,wireframe:!1,gradientColorSampler:this.options.textures.gradientColor});var a=this.options.thickness*L.a.easeOutQuad(this.lifeRate);o.uniformSet({modelViewMatrix:this.options.modelViewMatrix,size:[m.b.distance(this.options.prevPos,this.options.pos)+2*a*5,2*a*5]}),o.draw(r.indicesBufferData.length)}},{key:"lifeRate",get:function(){return this.options.lifespan/this.options.maxlife}}]),t}(),O=n(71),U=n.n(O),N=n(72),I=n.n(N),z=function(t,e,n){var r=Object(b.g)(t,e,n);return{program:r,attribLocations:{vertexPosition:b.b.attribFloat(t,r,"aVertexPosition",2),textureCoord:b.b.attribFloat(t,r,"aTextureCoord",2)},uniformLocations:{projectionMatrix:b.j.uniformMatrix4fv(t,r,"uProjectionMatrix"),modelViewMatrix:b.j.uniformMatrix4fv(t,r,"uModelViewMatrix"),gradientColorSampler:b.j.uniformTexture(t,r,"uGradientColorSampler",0),size:b.j.uniform2fv(t,r,"uSize"),wireframe:b.j.uniform1i(t,r,"uWireframe")}}},V=function(t){return Object.assign(Object(b.i)(t,z,U.a,I.a),{draw:function(e){t.drawElements(t.TRIANGLES,e,t.UNSIGNED_BYTE,0)}})},G=n(73),Y=n.n(G),W=n(74),X=n.n(W),Q=function(t,e,n){var r=Object(b.g)(t,e,n);return{program:r,attribLocations:{vertexPosition:b.b.attribFloat(t,r,"aVertexPosition",2),textureCoord:b.b.attribFloat(t,r,"aTextureCoord",2)},uniformLocations:{projectionMatrix:b.j.uniformMatrix4fv(t,r,"uProjectionMatrix"),flipY:b.j.uniform1f(t,r,"uFlipY"),glowSampler:b.j.uniformTexture(t,r,"uGlowSampler",0),sampler:b.j.uniformTexture(t,r,"uSampler",1),size:b.j.uniform2fv(t,r,"uSize"),time:b.j.uniform1f(t,r,"uTime")}}},q=function(t){return Object.assign(Object(b.i)(t,Q,Y.a,X.a),{draw:function(e){t.drawElements(t.TRIANGLES,e,t.UNSIGNED_BYTE,0)}})},H=n(75),Z=n.n(H),K=n(76),$=n.n(K),J=function(t,e,n){var r=Object(b.g)(t,e,n);return{program:r,attribLocations:{vertexPosition:b.b.attribFloat(t,r,"aVertexPosition",2),textureCoord:b.b.attribFloat(t,r,"aTextureCoord",2)},uniformLocations:{projectionMatrix:b.j.uniformMatrix4fv(t,r,"uProjectionMatrix"),noiseSampler:b.j.uniformTexture(t,r,"uNoiseSampler",0),gradientColorSampler:b.j.uniformTexture(t,r,"uGradientColorSampler",1),thicknessScaleSampler:b.j.uniformTexture(t,r,"uThicknessScaleSampler",2),length:b.j.uniform1f(t,r,"uLength"),time:b.j.uniform1f(t,r,"uTime"),density:b.j.uniform2fv(t,r,"uDensity"),fixed:b.j.uniform2fv(t,r,"uFixed"),radius:b.j.uniform2fv(t,r,"uRadius"),thickness:b.j.uniform2fv(t,r,"uThickness"),power:b.j.uniform1f(t,r,"uPower"),borderPower:b.j.uniform2fv(t,r,"uBorderPower"),gradientColorRate:b.j.uniform1f(t,r,"uGradientColorRate"),thicknessScaleRate:b.j.uniform1f(t,r,"uThicknessScaleRate"),expand:b.j.uniform1f(t,r,"uExpand"),sub:b.j.uniform1i(t,r,"uSub"),flow:b.j.uniform1i(t,r,"uFlow"),flowRate:b.j.uniform1f(t,r,"uFlowRate"),wireframe:b.j.uniform1i(t,r,"uWireframe")}}},tt=function(t){return Object.assign(Object(b.i)(t,J,Z.a,$.a),{draw:function(e){t.drawElements(t.TRIANGLES,e,t.UNSIGNED_BYTE,0)}})},et=function(t,e,n,r,o){o.framebufferTextures,o.size},nt=function(t,e,n,r,o){var a=o.now,i=o.delta,f=o.framebufferTextures,c=(o.mPos,o.size,o.pList),s=o.text01,l=o.blur01,d=o.composite01,v=o.particles,h=o.text01_posListG,p=o.text01_normalListG,g=u.a.create();if(u.a.ortho(g,0,t.canvas.clientWidth,t.canvas.clientHeight,0,.1,100),u.a.translate(g,g,[0,0,-1]),t.enable(t.CULL_FACE),t.enable(t.BLEND),t.clearColor(0,0,0,1),t.clearDepth(1),t.depthFunc(t.LEQUAL),t.clear(t.COLOR_BUFFER_BIT),Math.random()>.8)for(var x=Math.floor(Math.random()*h.length),b=Math.floor(Math.random()*h[x].length),M=0;M<2*Math.random()+1;M++)v.push(new B(t,{pos:m.b.add(h[x][b],s.pos),velocity:2+5*Math.random(),direct:m.b.getAngle(p[x][b])+.1*(Math.random()-.5)*Math.PI,lifespan:.3+.3*Math.random(),thickness:4+3*Math.random(),bufferData:n.model,shader:e.sparkShader,textures:{gradientColor:r.gradientColor}}));t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),s.draw(t,g,{framebufferTexture:f.text}),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),l.draw(t,g,{texture:f.text.texture,pos:[0,0],width:t.canvas.width,height:t.canvas.height,framebufferTexture:f.blur}),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),d.draw(t,g,{glowTexture:f.blur.texture,texture:f.text.texture,pos:[0,0],width:t.canvas.width,height:t.canvas.height,now:a}),t.blendFunc(t.ONE,t.ONE);for(var y=0;y<c.length;y++){var w=c[y];if(w.update(i),w.draw(t,g,{now:a}),w.tRate>.4&&w.tRate<.6&&Math.random()>.25)for(var R=w.options.pointList[0],S=w.options.pointList[1],C=m.b.sub(S,R),T=Math.atan2(C[1],C[0]),D=0;D<2;D++)v.push(new B(t,{pos:R,velocity:2+12*Math.random(),direct:T+(Math.random()-.5)*Math.PI,lifespan:.3+.3*Math.random(),thickness:4+3*Math.random(),bufferData:n.model,shader:e.sparkShader,textures:{gradientColor:r.gradientColor}}))}for(var E=0;E<c.length;E++){c[E].confirmRemove&&c.splice(E,1)}t.blendFunc(t.ONE,t.ONE);for(var P=0;P<v.length;P++){var _=v[P];_.update(i),_.lifeRate<=0&&v.splice(P,1)}for(var j=0;j<v.length;j++){v[j].draw(t,g)}};!function(){var t=document.getElementById("fps"),e=document.querySelector("#glcanvas"),n={alpha:!1},r=e.getContext("webgl2",n);if(r||(r=e.getContext("webgl",n)||e.getContext("experimental-webgl",n),!1),r){var a={sparkShader:V(r),blurShader:F(r),compositeShader:q(r),electricityModelShader:tt(r)},u={model:Object(h.c)(r),face:Object(h.a)(r)},f={noise:Object(b.h)(r,"../img/noise.1daf84e206d328e57277e9ce8efacd53.jpg"),gradientColor:Object(b.h)(r,"../img/gradientColor.f758487c0be0ec72cf38da5d7447431a.jpg"),thicknessScale:Object(b.h)(r,"../img/thicknessScale.b78b734236e1abee25cb773eeb8ff277.jpg")},c=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;if(!(t.length<=0)){var o=document.createElement("canvas"),a=o.getContext("2d"),i=x(a,t,e,r),u=i.pos,f=i.size;o.width=f[0]+2*n,o.height=f[1]+2*n,a.textAlign="start",a.textBaseline="hanging",a.font=e,a.fillStyle="#ffffff",a.fillTextWithSpacing(t,u[0]+n,u[1]+n,r);for(var c=a.getImageData(0,0,o.width,o.height),s=c.data,l=function(t,e,n){return 4*(e+n*t.width)},d=[[0,-1],[1,0],[0,1],[-1,0]],v=[],h=[],p=a.createImageData(c.width,c.height),g=function(t){for(var e=function(e){var n=l(c,e,t);if(s[n+3]>127&&d.some((function(n){return e+n[0]<0||e+n[0]>=c.width||t+n[1]<0||t+n[1]>=c.height||s[l(c,e+n[0],t+n[1])+3]<=127}))){p.data[n+0]=255,p.data[n+1]=255,p.data[n+2]=255,p.data[n+3]=255,v.push([e,t]);var r=d.map((function(r){return m.b.scale(r,s[n+3]-s[l(c,e+r[0],t+r[1])+3])})),o=[0,0];r.forEach((function(t){m.c.add(o,t)})),m.c.normalize(o),h.push(o)}},n=0;n<c.width;n++)e(n)},b=0;b<c.height;b++)g(b);for(var M=[],y=0;y<v.length-1;y++){for(var w=-1,R=y+1;R<v.length;R++){var S=m.b.abs(m.b.sub(v[y],v[R]));if(S[0]<=1&&S[1]<=1&&(w=R,S[0]*S[1]==0))break}if(w>=0){var C=[v[y+1],v[w]];v[w]=C[0],v[y+1]=C[1];var T=[h[y+1],h[w]];h[w]=T[0],h[y+1]=T[1]}else M.push(y+1)}M.push(v.length);for(var D=[],E=[],P=0,_=0;_<M.length;_++)D.push(v.slice(P,M[_])),E.push(h.slice(P,M[_])),P=M[_];return{posListG:D,normalListG:E}}}("POWER","bold 120px Courier New"),s=c.posListG,l=c.normalListG,d=s,v=l,p=new T(r);p.setText(r,"POWER","bold 120px Courier New"),p.pos=[.5*r.canvas.width-.5*p.width,.5*r.canvas.height-.5*p.height];var M=new k(r,{bufferData:u.face,shader:a.blurShader}),y=new A(r,{bufferData:u.face,shader:a.compositeShader}),w=[0,0],R=[0,0],S=null,C=[],D=[r.canvas.clientWidth,r.canvas.clientHeight],E={text:Object(b.c)(r),blur:Object(b.c)(r)},P=[];e.addEventListener("mousemove",(function(t){m.c.set(w,t.offsetX,t.offsetY);var e=function(t,e){for(var n={i:-1,j:-1,r:1/0},r=0;r<e.length;r++)for(var o=e[r],a=0;a<o.length;a++){var i=m.b.distance(o[a],t);i<n.r&&(n.i=r,n.j=a,n.r=i)}return n}(m.b.sub(w,p.pos),d);if(e.r>=200||S&&e.i!==S.i)C.filter((function(t){return"my"===t.group&&!t.removeState})).forEach((function(t){t.remove()}));else if(e.r<=150){if(m.c.set.apply(m.c,[R].concat(i()(m.b.add(d[e.i][e.j],p.pos)))),C.filter((function(t){return"my"===t.group&&!t.removeState})).length<=0){var n=new g(r,m.e,{group:"my",t:0,tMax:1.5,flow:!0,expand:140,pointList:[[].concat(R),[].concat(w),[].concat(w)],textures:{noise:f.noise,gradientColor:f.gradientColor,thicknessScale:f.thicknessScale},shader:a.electricityModelShader});n.onUpdate((function(t,e){var n=o()(t.options.pointList,3),r=n[0],a=n[1],u=n[2],f=m.b.distance(r,u),c=Math.min(Math.max(f-30,5),40),s=Math.min(Math.max((500-f)/f,.5),1.5);t.radius=[c,.8*c],t.power=s,t.removeState||m.c.set.apply(m.c,[r].concat(R)),t.options.n=Math.min(Math.max(Math.floor(m.b.distance(r,w)/8),3),30),m.c.set.apply(m.c,[u].concat(i()(m.b.mix(u,w,.5)))),m.c.set.apply(m.c,[a].concat(i()(m.b.mix(a,m.b.mix(r,u,.5),.25))))})),C.push(n)}}S=e})),e.addEventListener("mousedown",(function(t){m.c.set(w,t.pageX,t.pageY);for(var e=0;e<100;e++)P.push(new B(r,{pos:w,velocity:2+12*Math.random(),direct:2*Math.random()*Math.PI,lifespan:.3+.3*Math.random(),thickness:4+3*Math.random(),bufferData:u.model,shader:a.sparkShader,textures:{gradientColor:f.gradientColor}}))})),et(r,a,u,f,{framebufferTextures:E,size:D});var _=Date.now();requestAnimationFrame((function e(n){var o=Date.now(),i=.001*(o-_);t.textContent=Math.round(1/i),_=o,requestAnimationFrame(e),nt(r,a,u,f,{now:n,delta:i,mPos:w,framebufferTextures:E,size:D,pList:C,text01:p,blur01:M,composite01:y,particles:P,text01_posListG:d,text01_normalListG:v})}))}else alert("無法初始化WebGL。您的瀏覽器或機器可能不支持它。")}()}]);