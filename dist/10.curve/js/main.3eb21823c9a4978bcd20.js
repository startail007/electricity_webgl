!function(r){var t={};function e(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return r[n].call(a.exports,a,a.exports,e),a.l=!0,a.exports}e.m=r,e.c=t,e.d=function(r,t,n){e.o(r,t)||Object.defineProperty(r,t,{enumerable:!0,get:n})},e.r=function(r){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},e.t=function(r,t){if(1&t&&(r=e(r)),8&t)return r;if(4&t&&"object"==typeof r&&r&&r.__esModule)return r;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:r}),2&t&&"string"!=typeof r)for(var a in r)e.d(n,a,function(t){return r[t]}.bind(null,a));return n},e.n=function(r){var t=r&&r.__esModule?function(){return r.default}:function(){return r};return e.d(t,"a",t),t},e.o=function(r,t){return Object.prototype.hasOwnProperty.call(r,t)},e.p="",e(e.s=67)}({0:function(r,t,e){"use strict";e.d(t,"h",(function(){return b})),e.d(t,"f",(function(){return n})),e.d(t,"c",(function(){return v})),e.d(t,"a",(function(){return u})),e.d(t,"d",(function(){return o})),e.d(t,"g",(function(){return f})),e.d(t,"b",(function(){return s})),e.d(t,"i",(function(){return d})),e.d(t,"e",(function(){return m})),e.d(t,"j",(function(){return p}));var n=function(r,t,e){var n=a(r,r.VERTEX_SHADER,t),u=a(r,r.FRAGMENT_SHADER,e),o=r.createProgram();return r.attachShader(o,n),r.attachShader(o,u),r.linkProgram(o),r.getProgramParameter(o,r.LINK_STATUS)?o:(alert("無法初始化著色器程序: "+r.getProgramInfoLog(o)),null)},a=function(r,t,e){var n=r.createShader(t);return r.shaderSource(n,e),r.compileShader(n),r.getShaderParameter(n,r.COMPILE_STATUS)?n:(alert("編譯著色器時發生錯誤: "+r.getShaderInfoLog(n)),r.deleteShader(n),null)},u=function(r,t,e){var n,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Float32Array,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:r.STATIC_DRAW,o=r.createBuffer(),i=0,f={buffer:o,get data(){return n},get length(){return n.length},set:function(t){n=new a(t),i=100*Math.ceil(n.length/e/100),r.bindBuffer(r.ARRAY_BUFFER,o),r.bufferData(r.ARRAY_BUFFER,i*e*4,u),r.bufferSubData(r.ARRAY_BUFFER,0,n)},add:function(t){var f=n.length,c=100*Math.floor(n.length/e/100);c>=i&&(i=c+100,r.bindBuffer(r.ARRAY_BUFFER,o),r.bufferData(r.ARRAY_BUFFER,i*e*4,u),r.bufferSubData(r.ARRAY_BUFFER,0,n));var l=new a(f+e);l.set(n),n=l,this.item(f/e,t)},item:function(t,u){var i=new a(u);n.set(i,t*e),r.bindBuffer(r.ARRAY_BUFFER,o),r.bufferSubData(r.ARRAY_BUFFER,t*e*4,i)},getItem:function(r){return Array.from(n.slice(r*e,(r+1)*e))}};return f.set(t),f},o=function(r,t){var e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Uint8Array,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r.STATIC_DRAW,u=r.createBuffer(),o=0,i=3,f={buffer:u,get data(){return e},get length(){return e.length},set:function(t){e=new n(t),o=100*Math.ceil(e.length/i/100),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,u),r.bufferData(r.ELEMENT_ARRAY_BUFFER,o*i*4,a),r.bufferSubData(r.ELEMENT_ARRAY_BUFFER,0,e)},add:function(t){var f=e.length,c=100*Math.floor(e.length/i/100);c>=o&&(o=c+100,r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,u),r.bufferData(r.ELEMENT_ARRAY_BUFFER,o*i*4,a),r.bufferSubData(r.ELEMENT_ARRAY_BUFFER,0,e));var l=new n(f+i);l.set(e),e=l,this.item(f/i,t)},item:function(t,a){var o=new n(a);e.set(o,t*i),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,u),r.bufferSubData(r.ELEMENT_ARRAY_BUFFER,t*i*4,o)},getItem:function(r){return Array.from(e.slice(r*i,(r+1)*i))}};return f.set(t),f},i=function(r){var t=r.createTexture();return r.bindTexture(r.TEXTURE_2D,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),t},f=function(r,t){var e=i(r),n=new Image;return n.onload=function(){e.width=n.width,e.height=n.height,r.bindTexture(r.TEXTURE_2D,e),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,n)},n.src=t,e},c=function(r,t,e,n){r.bindFramebuffer(r.FRAMEBUFFER,t),void 0!==e&&void 0!==n&&r.viewport(0,0,e,n)},l=function(r,t){var e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t?e?c(r,t.framebuffer,t.width,t.height):c(r,t.framebuffer):e?c(r,null,r.canvas.width,r.canvas.height):c(r,null)},v=function(r,t,e){var n={width:t||r.canvas.clientWidth,height:e||r.canvas.clientHeight},a=i(r);n.texture=a,r.texImage2D(r.TEXTURE_2D,0,r.RGBA,n.width,n.height,0,r.RGBA,r.UNSIGNED_BYTE,null);var u=r.createFramebuffer();return n.framebuffer=u,r.bindFramebuffer(r.FRAMEBUFFER,u),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,a,0),r.bindFramebuffer(r.FRAMEBUFFER,null),n},s={attribFloat:function(r,t,e,n){var a=r.getAttribLocation(t,e);return r.enableVertexAttribArray(a),function(t){r.bindBuffer(r.ARRAY_BUFFER,t),r.vertexAttribPointer(a,n,r.FLOAT,!1,0,0)}}},d={uniform1f:function(r,t,e){var n=r.getUniformLocation(t,e);return function(t){r.uniform1f(n,t)}},uniform2fv:function(r,t,e){var n=r.getUniformLocation(t,e);return function(t){r.uniform2fv(n,t)}},uniform3fv:function(r,t,e){var n=r.getUniformLocation(t,e);return function(t){r.uniform3fv(n,t)}},uniformTexture:function(r,t,e,n){var a=r.getUniformLocation(t,e);return function(t){r.activeTexture(r.TEXTURE0+n),r.bindTexture(r.TEXTURE_2D,t),r.uniform1i(a,n)}},uniform1i:function(r,t,e){var n=r.getUniformLocation(t,e);return function(t){r.uniform1i(n,t)}},uniformMatrix4fv:function(r,t,e){var n=r.getUniformLocation(t,e);return function(t){r.uniformMatrix4fv(n,!1,t)}}},b=function(r,t,e,n,a){var u=t(r,e,n);return{programInfo:u,use:function(){r.useProgram(u.program)},attribSet:function(r){for(var t in r)u.attribLocations[t]&&u.attribLocations[t](r[t])},uniformSet:function(r){for(var t in r)u.uniformLocations[t]&&u.uniformLocations[t](r[t])}}},m=function(r){return[[r[0],r[1]],[r[2],r[1]],[r[2],r[3]],[r[0],r[3]]].flat()},E=function(r){r.clearColor(0,0,0,1),r.clear(r.COLOR_BUFFER_BIT)},p=function(r,t){var e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];l(r,t),e&&E(r)}},1:function(r,t,e){"use strict";e.d(t,"a",(function(){return f})),e.d(t,"b",(function(){return c}));var n=e(3),a=e.n(n),u=e(4),o=e.n(u),i=e(2),f=function(){function r(){a()(this,r)}return o()(r,null,[{key:"normalize",value:function(t){return r.length(t)?r.scale(t,1/r.length(t)):t}},{key:"rotate",value:function(r,t){var e=Math.cos(t),n=Math.sin(t);return[r[0]*e-r[1]*n,r[1]*e+r[0]*n]}},{key:"dot",value:function(r,t){return r[0]*t[0]+r[1]*t[1]}},{key:"cross",value:function(r,t){return r[0]*t[1]-r[1]*t[0]}},{key:"add",value:function(r,t){return[r[0]+t[0],r[1]+t[1]]}},{key:"sub",value:function(r,t){return[r[0]-t[0],r[1]-t[1]]}},{key:"projection",value:function(t,e){var n=r.dot(t,e)/r.dot(e,e);return[e[0]*n,e[1]*n]}},{key:"length",value:function(t){return Math.sqrt(r.dot(t,t))}},{key:"mul",value:function(r,t){return[r[0]*t[0],r[1]*t[1]]}},{key:"div",value:function(r,t){return[r[0]/t[0],r[1]/t[1]]}},{key:"scale",value:function(r,t){return[r[0]*t,r[1]*t]}},{key:"collisionCalc",value:function(t,e,n,a){return r.scale(r.add(r.scale(t,n-a),r.scale(e,2*a)),1/(n+a))}},{key:"getAngle",value:function(r){return Math.atan2(r[1],r[0])}},{key:"floor",value:function(r){return[Math.floor(r[0]),Math.floor(r[1])]}},{key:"fract",value:function(r){return[i.a.fract(r[0]),i.a.fract(r[1])]}},{key:"sin",value:function(r){return[Math.sin(r[0]),Math.sin(r[1])]}},{key:"cos",value:function(r){return[Math.cos(r[0]),Math.cos(r[1])]}},{key:"distance",value:function(t,e){return r.length(r.sub(e,t))}},{key:"mix",value:function(r,t,e){return[i.a.mix(r[0],t[0],e),i.a.mix(r[1],t[1],e)]}},{key:"abs",value:function(r){return[Math.abs(r[0]),Math.abs(r[1])]}},{key:"getLine",value:function(t,e){return{pos:t,dir:r.sub(e,t)}}}]),r}(),c=function(){function r(){a()(this,r)}return o()(r,null,[{key:"set",value:function(r,t,e){return r[0]=t,r[1]=e,r}},{key:"normalize",value:function(t){var e=f.length(t);return e&&r.scale(t,1/e),t}},{key:"add",value:function(r,t){return r[0]+=t[0],r[1]+=t[1],r}},{key:"sub",value:function(r,t){return r[0]-=t[0],r[1]-=t[1],r}},{key:"scale",value:function(r,t){return r[0]*=t,r[1]*=t,r}},{key:"rotate",value:function(r,t){var e=Math.cos(t),n=Math.sin(t),a=[r[0]*e-r[1]*n,r[1]*e+r[0]*n];return r[0]=a[0],r[1]=a[1],r}}]),r}()},2:function(r,t,e){"use strict";e.d(t,"a",(function(){return i}));var n=e(3),a=e.n(n),u=e(4),o=e.n(u),i=function(){function r(){a()(this,r)}return o()(r,null,[{key:"mix",value:function(r,t,e){return r*(1-e)+t*e}},{key:"fract",value:function(r){return(r%=1)<0?r+1:r}}]),r}()},3:function(r,t){r.exports=function(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}},4:function(r,t){function e(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}r.exports=function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}},47:function(r,t){r.exports="precision mediump float;\r\nvarying vec2 vTextureCoord;\r\nuniform lowp vec2 uSize;\r\nuniform float uTime;\r\nuniform vec2 uStartPos;\r\nuniform vec2 uControlPos;\r\nuniform vec2 uEndPos;\r\nconst float pi=3.14159265359;\r\n\r\nfloat distLine(vec2 p,vec2 a,vec2 b,float w){\r\n  vec2 pa=p-a;\r\n  vec2 ba=b-a;\r\n  float t=clamp(dot(pa,ba)/dot(ba,ba),0.,1.);\r\n  return length(pa-ba*t)/w;\r\n}\r\nfloat ball(vec2 f,float r){\r\n  return smoothstep(1.,.99,length(f)/r);\r\n}\r\nfloat cross(vec2 v0,vec2 v1){\r\n  return v0.x*v1.y-v0.y*v1.x;\r\n}\r\nvec2 getQuadraticCurveTo(vec2 p0,vec2 p1,vec2 p2,float t){\r\n  return p0*(1.-t)*(1.-t)+p1*2.*(1.-t)*t+p2*t*t;\r\n}\r\nvec2 getQuadraticCurveToTangent(vec2 p0,vec2 p1,vec2 p2,float t){\r\n  return 2.*t*(p0-p1*2.+p2)+2.*(-p0+p1);\r\n}\r\n/*float distLine0(vec2 p,vec2 a,vec2 b){\r\n  vec2 pa=p-a;\r\n  vec2 ba=b-a;\r\n  float t=clamp(dot(pa,ba)/dot(ba,ba),0.,1.);\r\n  return length(pa-ba*t);\r\n}*/\r\nvec2 quadraticCurve(vec2 p,vec2 a,vec2 b,vec2 c,float w){\r\n  float s=.5;\r\n  float rate=.5;\r\n  const int N=8;\r\n  vec2 p0=getQuadraticCurveTo(a,b,c,0.);\r\n  vec2 p2=getQuadraticCurveTo(a,b,c,1.);\r\n  vec2 p1=getQuadraticCurveTo(a,b,c,rate);\r\n  for(int i=0;i<N;i++){\r\n    /*float line0 = distLine(p,p1,p0,1.);\r\n    float line1 = distLine(p,p1,p2,1.);\r\n    if(line0<line1){\r\n      rate-=s*.5;\r\n      p2 = p1;\r\n    }else if(line0>line1){\r\n      rate+=s*.5;\r\n      p0 = p1;\r\n    }else{*/\r\n      vec2 t=getQuadraticCurveToTangent(a,b,c,rate);\r\n      t=vec2(-t.y,t.x);\r\n      if(cross(p-p1,t)<0.){\r\n        rate-=s*.5;\r\n        p2=p1;\r\n      }else{\r\n        rate+=s*.5;\r\n        p0=p1;\r\n      }\r\n    //}\r\n    s*=.5;\r\n    p1=getQuadraticCurveTo(a,b,c,rate);\r\n  }\r\n  //return vec2(length(p-p1)/w,rate);\r\n  return vec2(distLine(p,p0,p2,w),rate);\r\n}\r\nvoid main()\r\n{\r\n  \r\n  vec4 color=vec4(0.);\r\n  vec2 uv=vTextureCoord*uSize;\r\n  \r\n  vec2 uv0=quadraticCurve(uv,uStartPos,uControlPos,uEndPos,5.);\r\n  color+=uv0.y;\r\n  color=mix(color,vec4(1.,0.,0.,1.),smoothstep(1.,0.,uv0.x));\r\n  \r\n  vec2 p=getQuadraticCurveTo(uStartPos,uControlPos,uEndPos,fract(uTime*.1));\r\n  color+=ball(uv-p,5.);\r\n  \r\n  vec2 t=getQuadraticCurveToTangent(uStartPos,uControlPos,uEndPos,fract(uTime*.1));\r\n  t=vec2(-t.y,t.x);\r\n  color+=smoothstep(1.,0.,distLine(uv,p,p+10.*normalize(t),1.));\r\n  \r\n  gl_FragColor=color;\r\n}\r\n\r\n"},5:function(r,t){r.exports="attribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\nvarying highp vec2 vTextureCoord;\r\nuniform float uFlipY;\r\nvoid main(void){\r\n  vTextureCoord=aTextureCoord;\r\n  gl_Position=vec4((2.*aVertexPosition+vec2(-1.,-1.))*vec2(1.,uFlipY),0.,1.);\r\n}"},67:function(r,t,e){"use strict";e.r(t);var n=e(0),a=e(1),u=e(5),o=e.n(u),i=e(47),f=e.n(i),c=function(r,t,e){var a=Object(n.f)(r,t,e);return{program:a,attribLocations:{vertexPosition:n.b.attribFloat(r,a,"aVertexPosition",2),textureCoord:n.b.attribFloat(r,a,"aTextureCoord",2)},uniformLocations:{flipY:n.i.uniform1f(r,a,"uFlipY"),size:n.i.uniform2fv(r,a,"uSize"),time:n.i.uniform1f(r,a,"uTime"),startPos:n.i.uniform2fv(r,a,"uStartPos"),controlPos:n.i.uniform2fv(r,a,"uControlPos"),endPos:n.i.uniform2fv(r,a,"uEndPos")}}},l=function(r){return Object.assign(Object(n.h)(r,c,o.a,f.a),{draw:function(t){r.drawElements(r.TRIANGLES,t,r.UNSIGNED_BYTE,0)}})};function v(r){var t=[[0,0],[1,0],[1,1],[0,1]].flat(),e=Object(n.a)(r,t,2),a=[[0,0],[1,0],[1,1],[0,1]].flat(),u=Object(n.a)(r,a,2),o=[[0,1,3],[1,2,3]].flat();return{positionBufferData:e,textureCoordinatesBufferData:u,indicesBufferData:Object(n.d)(r,o)}}!function(){var r=document.querySelector("#glcanvas"),t=r.getContext("webgl",{alpha:!1});if(!t)return void alert("無法初始化WebGL。您的瀏覽器或機器可能不支持它。");var e={quadraticCurveShader:l(t)},u={face:v(t),view:v(t)},o=[.5*t.canvas.width,.5*t.canvas.height];r.addEventListener("mousemove",(function(r){a.b.set(o,r.pageX,r.pageY)}));var i=[t.canvas.clientWidth,t.canvas.clientHeight],f={};var c=0;requestAnimationFrame((function r(a){var l=.001*(a-c);c=a,requestAnimationFrame(r),function(r,t,e,a,u){var o=u.now,i=(u.framebufferTextures,u.mPos,u.size),f=e.face,c=t.quadraticCurveShader;c.use(),c.attribSet({vertexPosition:f.positionBufferData.buffer,textureCoord:f.textureCoordinatesBufferData.buffer}),c.uniformSet({size:i,time:.001*o,flipY:-1,startPos:[300,400],controlPos:[400,300],endPos:[500,400]}),Object(n.j)(r),c.draw(f.indicesBufferData.length)}(t,e,u,0,{now:a,delta:l,mPos:o,framebufferTextures:f,size:i})}))}()}});