!function(t){var r={};function e(n){if(r[n])return r[n].exports;var a=r[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,e),a.l=!0,a.exports}e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var a in t)e.d(n,a,function(r){return t[r]}.bind(null,a));return n},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},e.p="",e(e.s=67)}({0:function(t,r,e){"use strict";e.d(r,"h",(function(){return b})),e.d(r,"f",(function(){return n})),e.d(r,"c",(function(){return v})),e.d(r,"a",(function(){return u})),e.d(r,"d",(function(){return o})),e.d(r,"g",(function(){return f})),e.d(r,"b",(function(){return s})),e.d(r,"i",(function(){return d})),e.d(r,"e",(function(){return m})),e.d(r,"j",(function(){return p}));var n=function(t,r,e){var n=a(t,t.VERTEX_SHADER,r),u=a(t,t.FRAGMENT_SHADER,e),o=t.createProgram();return t.attachShader(o,n),t.attachShader(o,u),t.linkProgram(o),t.getProgramParameter(o,t.LINK_STATUS)?o:(alert("無法初始化著色器程序: "+t.getProgramInfoLog(o)),null)},a=function(t,r,e){var n=t.createShader(r);return t.shaderSource(n,e),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)?n:(alert("編譯著色器時發生錯誤: "+t.getShaderInfoLog(n)),t.deleteShader(n),null)},u=function(t,r,e){var n,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Float32Array,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:t.STATIC_DRAW,o=t.createBuffer(),i=0,f={buffer:o,get data(){return n},get length(){return n.length},set:function(r){n=new a(r),i=100*Math.ceil(n.length/e/100),t.bindBuffer(t.ARRAY_BUFFER,o),t.bufferData(t.ARRAY_BUFFER,i*e*4,u),t.bufferSubData(t.ARRAY_BUFFER,0,n)},add:function(r){var f=n.length,c=100*Math.floor(n.length/e/100);c>=i&&(i=c+100,t.bindBuffer(t.ARRAY_BUFFER,o),t.bufferData(t.ARRAY_BUFFER,i*e*4,u),t.bufferSubData(t.ARRAY_BUFFER,0,n));var l=new a(f+e);l.set(n),n=l,this.item(f/e,r)},item:function(r,u){var i=new a(u);n.set(i,r*e),t.bindBuffer(t.ARRAY_BUFFER,o),t.bufferSubData(t.ARRAY_BUFFER,r*e*4,i)},getItem:function(t){return Array.from(n.slice(t*e,(t+1)*e))}};return f.set(r),f},o=function(t,r){var e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Uint8Array,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.STATIC_DRAW,u=t.createBuffer(),o=0,i=3,f={buffer:u,get data(){return e},get length(){return e.length},set:function(r){e=new n(r),o=100*Math.ceil(e.length/i/100),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,u),t.bufferData(t.ELEMENT_ARRAY_BUFFER,o*i*4,a),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,e)},add:function(r){var f=e.length,c=100*Math.floor(e.length/i/100);c>=o&&(o=c+100,t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,u),t.bufferData(t.ELEMENT_ARRAY_BUFFER,o*i*4,a),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,e));var l=new n(f+i);l.set(e),e=l,this.item(f/i,r)},item:function(r,a){var o=new n(a);e.set(o,r*i),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,u),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,r*i*4,o)},getItem:function(t){return Array.from(e.slice(t*i,(t+1)*i))}};return f.set(r),f},i=function(t){var r=t.createTexture();return t.bindTexture(t.TEXTURE_2D,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),r},f=function(t,r){var e=i(t),n=new Image;return n.onload=function(){e.width=n.width,e.height=n.height,t.bindTexture(t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)},n.src=r,e},c=function(t,r,e,n){t.bindFramebuffer(t.FRAMEBUFFER,r),void 0!==e&&void 0!==n&&t.viewport(0,0,e,n)},l=function(t,r){var e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];r?e?c(t,r.framebuffer,r.width,r.height):c(t,r.framebuffer):e?c(t,null,t.canvas.width,t.canvas.height):c(t,null)},v=function(t,r,e){var n={width:r||t.canvas.clientWidth,height:e||t.canvas.clientHeight},a=i(t);n.texture=a,t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,null);var u=t.createFramebuffer();return n.framebuffer=u,t.bindFramebuffer(t.FRAMEBUFFER,u),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,a,0),t.bindFramebuffer(t.FRAMEBUFFER,null),n},s={attribFloat:function(t,r,e,n){var a=t.getAttribLocation(r,e);return t.enableVertexAttribArray(a),function(r){t.bindBuffer(t.ARRAY_BUFFER,r),t.vertexAttribPointer(a,n,t.FLOAT,!1,0,0)}}},d={uniform1f:function(t,r,e){var n=t.getUniformLocation(r,e);return function(r){t.uniform1f(n,r)}},uniform2fv:function(t,r,e){var n=t.getUniformLocation(r,e);return function(r){t.uniform2fv(n,r)}},uniform3fv:function(t,r,e){var n=t.getUniformLocation(r,e);return function(r){t.uniform3fv(n,r)}},uniformTexture:function(t,r,e,n){var a=t.getUniformLocation(r,e);return function(r){t.activeTexture(t.TEXTURE0+n),t.bindTexture(t.TEXTURE_2D,r),t.uniform1i(a,n)}},uniform1i:function(t,r,e){var n=t.getUniformLocation(r,e);return function(r){t.uniform1i(n,r)}},uniformMatrix4fv:function(t,r,e){var n=t.getUniformLocation(r,e);return function(r){t.uniformMatrix4fv(n,!1,r)}}},b=function(t,r,e,n,a){var u=r(t,e,n);return{programInfo:u,use:function(){t.useProgram(u.program)},attribSet:function(t){for(var r in t)u.attribLocations[r]&&u.attribLocations[r](t[r])},uniformSet:function(t){for(var r in t)u.uniformLocations[r]&&u.uniformLocations[r](t[r])},elementSet:function(r){t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r)}}},m=function(t){return[[t[0],t[1]],[t[2],t[1]],[t[2],t[3]],[t[0],t[3]]].flat()},E=function(t){t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT)},p=function(t,r){var e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];l(t,r,n),e&&E(t)}},1:function(t,r,e){"use strict";e.d(r,"a",(function(){return f})),e.d(r,"b",(function(){return c}));var n=e(3),a=e.n(n),u=e(4),o=e.n(u),i=e(2),f=function(){function t(){a()(this,t)}return o()(t,null,[{key:"normalize",value:function(r){return t.length(r)?t.scale(r,1/t.length(r)):r}},{key:"rotate",value:function(t,r){var e=Math.cos(r),n=Math.sin(r);return[t[0]*e-t[1]*n,t[1]*e+t[0]*n]}},{key:"dot",value:function(t,r){return t[0]*r[0]+t[1]*r[1]}},{key:"cross",value:function(t,r){return t[0]*r[1]-t[1]*r[0]}},{key:"add",value:function(t,r){return[t[0]+r[0],t[1]+r[1]]}},{key:"sub",value:function(t,r){return[t[0]-r[0],t[1]-r[1]]}},{key:"projection",value:function(r,e){var n=t.dot(r,e)/t.dot(e,e);return[e[0]*n,e[1]*n]}},{key:"length",value:function(r){return Math.sqrt(t.dot(r,r))}},{key:"mul",value:function(t,r){return[t[0]*r[0],t[1]*r[1]]}},{key:"div",value:function(t,r){return[t[0]/r[0],t[1]/r[1]]}},{key:"scale",value:function(t,r){return[t[0]*r,t[1]*r]}},{key:"collisionCalc",value:function(r,e,n,a){return t.scale(t.add(t.scale(r,n-a),t.scale(e,2*a)),1/(n+a))}},{key:"getAngle",value:function(t){return Math.atan2(t[1],t[0])}},{key:"floor",value:function(t){return[Math.floor(t[0]),Math.floor(t[1])]}},{key:"fract",value:function(t){return[i.a.fract(t[0]),i.a.fract(t[1])]}},{key:"sin",value:function(t){return[Math.sin(t[0]),Math.sin(t[1])]}},{key:"cos",value:function(t){return[Math.cos(t[0]),Math.cos(t[1])]}},{key:"distance",value:function(r,e){return t.length(t.sub(e,r))}},{key:"mix",value:function(t,r,e){return[i.a.mix(t[0],r[0],e),i.a.mix(t[1],r[1],e)]}},{key:"abs",value:function(t){return[Math.abs(t[0]),Math.abs(t[1])]}},{key:"getLine",value:function(r,e){return{pos:r,dir:t.sub(e,r)}}}]),t}(),c=function(){function t(){a()(this,t)}return o()(t,null,[{key:"set",value:function(t,r,e){return t[0]=r,t[1]=e,t}},{key:"normalize",value:function(r){var e=f.length(r);return e&&t.scale(r,1/e),r}},{key:"add",value:function(t,r){return t[0]+=r[0],t[1]+=r[1],t}},{key:"sub",value:function(t,r){return t[0]-=r[0],t[1]-=r[1],t}},{key:"scale",value:function(t,r){return t[0]*=r,t[1]*=r,t}},{key:"rotate",value:function(t,r){var e=Math.cos(r),n=Math.sin(r),a=[t[0]*e-t[1]*n,t[1]*e+t[0]*n];return t[0]=a[0],t[1]=a[1],t}}]),t}()},2:function(t,r,e){"use strict";e.d(r,"a",(function(){return i}));var n=e(3),a=e.n(n),u=e(4),o=e.n(u),i=function(){function t(){a()(this,t)}return o()(t,null,[{key:"mix",value:function(t,r,e){return t*(1-e)+r*e}},{key:"fract",value:function(t){return(t%=1)<0?t+1:t}}]),t}()},3:function(t,r){t.exports=function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}},4:function(t,r){function e(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}t.exports=function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}},47:function(t,r){t.exports="precision mediump float;\r\nvarying vec2 vTextureCoord;\r\nuniform lowp vec2 uSize;\r\nuniform float uTime;\r\nuniform vec2 uStartPos;\r\nuniform vec2 uControlPos;\r\nuniform vec2 uEndPos;\r\nconst float pi=3.14159265359;\r\n\r\nfloat distLine(vec2 p,vec2 a,vec2 b,float w){\r\n  vec2 pa=p-a;\r\n  vec2 ba=b-a;\r\n  float t=clamp(dot(pa,ba)/dot(ba,ba),0.,1.);\r\n  return length(pa-ba*t)/w;\r\n}\r\nfloat ball(vec2 f,float r){\r\n  return smoothstep(1.,.99,length(f)/r);\r\n}\r\nfloat cross(vec2 v0,vec2 v1){\r\n  return v0.x*v1.y-v0.y*v1.x;\r\n}\r\nvec2 getQuadraticCurveTo(vec2 p0,vec2 p1,vec2 p2,float t){\r\n  return p0*(1.-t)*(1.-t)+p1*2.*(1.-t)*t+p2*t*t;\r\n}\r\nvec2 getQuadraticCurveToTangent(vec2 p0,vec2 p1,vec2 p2,float t){\r\n  return 2.*t*(p0-p1*2.+p2)+2.*(-p0+p1);\r\n}\r\n/*float distLine0(vec2 p,vec2 a,vec2 b){\r\n  vec2 pa=p-a;\r\n  vec2 ba=b-a;\r\n  float t=clamp(dot(pa,ba)/dot(ba,ba),0.,1.);\r\n  return length(pa-ba*t);\r\n}*/\r\nvec2 quadraticCurve(vec2 p,vec2 a,vec2 b,vec2 c,float w){\r\n  float s=.5;\r\n  float rate=.5;\r\n  const int N=8;\r\n  vec2 p0=getQuadraticCurveTo(a,b,c,0.);\r\n  vec2 p2=getQuadraticCurveTo(a,b,c,1.);\r\n  vec2 p1=getQuadraticCurveTo(a,b,c,rate);\r\n  for(int i=0;i<N;i++){\r\n    /*float line0 = distLine(p,p1,p0,1.);\r\n    float line1 = distLine(p,p1,p2,1.);\r\n    if(line0<line1){\r\n      rate-=s*.5;\r\n      p2 = p1;\r\n    }else if(line0>line1){\r\n      rate+=s*.5;\r\n      p0 = p1;\r\n    }else{*/\r\n      vec2 t=getQuadraticCurveToTangent(a,b,c,rate);\r\n      t=vec2(-t.y,t.x);\r\n      if(cross(p-p1,t)<0.){\r\n        rate-=s*.5;\r\n        p2=p1;\r\n      }else{\r\n        rate+=s*.5;\r\n        p0=p1;\r\n      }\r\n    //}\r\n    s*=.5;\r\n    p1=getQuadraticCurveTo(a,b,c,rate);\r\n  }\r\n  //return vec2(length(p-p1)/w,rate);\r\n  return vec2(distLine(p,p0,p2,w),rate);\r\n}\r\nvoid main()\r\n{\r\n  \r\n  vec4 color=vec4(0.);\r\n  vec2 uv=vTextureCoord*uSize;\r\n  \r\n  vec2 uv0=quadraticCurve(uv,uStartPos,uControlPos,uEndPos,5.);\r\n  color+=uv0.y;\r\n  color=mix(color,vec4(1.,0.,0.,1.),smoothstep(1.,0.,uv0.x));\r\n  \r\n  vec2 p=getQuadraticCurveTo(uStartPos,uControlPos,uEndPos,fract(uTime*.1));\r\n  color+=ball(uv-p,5.);\r\n  \r\n  vec2 t=getQuadraticCurveToTangent(uStartPos,uControlPos,uEndPos,fract(uTime*.1));\r\n  t=vec2(-t.y,t.x);\r\n  color+=smoothstep(1.,0.,distLine(uv,p,p+10.*normalize(t),1.));\r\n  \r\n  gl_FragColor=color;\r\n}\r\n\r\n"},5:function(t,r){t.exports="attribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\nvarying highp vec2 vTextureCoord;\r\nuniform float uFlipY;\r\nvoid main(void){\r\n  vTextureCoord=aTextureCoord;\r\n  gl_Position=vec4((2.*aVertexPosition+vec2(-1.,-1.))*vec2(1.,uFlipY),0.,1.);\r\n}"},67:function(t,r,e){"use strict";e.r(r);var n=e(0),a=e(1),u=e(5),o=e.n(u),i=e(47),f=e.n(i),c=function(t,r,e){var a=Object(n.f)(t,r,e);return{program:a,attribLocations:{vertexPosition:n.b.attribFloat(t,a,"aVertexPosition",2),textureCoord:n.b.attribFloat(t,a,"aTextureCoord",2)},uniformLocations:{flipY:n.i.uniform1f(t,a,"uFlipY"),size:n.i.uniform2fv(t,a,"uSize"),time:n.i.uniform1f(t,a,"uTime"),startPos:n.i.uniform2fv(t,a,"uStartPos"),controlPos:n.i.uniform2fv(t,a,"uControlPos"),endPos:n.i.uniform2fv(t,a,"uEndPos")}}},l=function(t){return Object.assign(Object(n.h)(t,c,o.a,f.a),{draw:function(r){t.drawElements(t.TRIANGLES,r,t.UNSIGNED_BYTE,0)}})};function v(t){var r=[[0,0],[1,0],[1,1],[0,1]].flat(),e=Object(n.a)(t,r,2),a=[[0,0],[1,0],[1,1],[0,1]].flat(),u=Object(n.a)(t,a,2),o=[[0,1,3],[1,2,3]].flat();return{positionBufferData:e,textureCoordinatesBufferData:u,indicesBufferData:Object(n.d)(t,o)}}!function(){var t=document.querySelector("#glcanvas"),r=t.getContext("webgl",{alpha:!1});if(!r)return void alert("無法初始化WebGL。您的瀏覽器或機器可能不支持它。");var e={quadraticCurveShader:l(r)},u={face:v(r),view:v(r)},o=[.5*r.canvas.width,.5*r.canvas.height];t.addEventListener("mousemove",(function(t){a.b.set(o,t.pageX,t.pageY)}));var i=[r.canvas.clientWidth,r.canvas.clientHeight],f={};var c=0;requestAnimationFrame((function t(a){var l=.001*(a-c);c=a,requestAnimationFrame(t),function(t,r,e,a,u){var o=u.now,i=(u.framebufferTextures,u.mPos,u.size),f=e.face,c=r.quadraticCurveShader;c.use(),c.attribSet({vertexPosition:f.positionBufferData.buffer,textureCoord:f.textureCoordinatesBufferData.buffer}),c.uniformSet({size:i,time:.001*o,flipY:-1,startPos:[300,400],controlPos:[400,300],endPos:[500,400]}),Object(n.j)(t),c.draw(f.indicesBufferData.length)}(r,e,u,0,{now:a,delta:l,mPos:o,framebufferTextures:f,size:i})}))}()}});