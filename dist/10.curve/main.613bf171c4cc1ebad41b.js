!function(e){var t={};function r(n){if(t[n])return t[n].exports;var u=t[n]={i:n,l:!1,exports:{}};return e[n].call(u.exports,u,u.exports,r),u.l=!0,u.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var u in e)r.d(n,u,function(t){return e[t]}.bind(null,u));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=71)}({0:function(e,t,r){"use strict";r.d(t,"h",(function(){return b})),r.d(t,"f",(function(){return n})),r.d(t,"c",(function(){return v})),r.d(t,"a",(function(){return a})),r.d(t,"d",(function(){return o})),r.d(t,"g",(function(){return f})),r.d(t,"b",(function(){return s})),r.d(t,"i",(function(){return d})),r.d(t,"e",(function(){return m})),r.d(t,"j",(function(){return p}));var n=function(e,t,r){var n=u(e,e.VERTEX_SHADER,t),a=u(e,e.FRAGMENT_SHADER,r),o=e.createProgram();return e.attachShader(o,n),e.attachShader(o,a),e.linkProgram(o),e.getProgramParameter(o,e.LINK_STATUS)?o:(alert("無法初始化著色器程序: "+e.getProgramInfoLog(o)),null)},u=function(e,t,r){var n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)?n:(alert("編譯著色器時發生錯誤: "+e.getShaderInfoLog(n)),e.deleteShader(n),null)},a=function(e,t,r){var n,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Float32Array,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e.STATIC_DRAW,o=e.createBuffer(),i=0,f={buffer:o,get data(){return n},get length(){return n.length},set:function(t){n=new u(t),i=100*Math.ceil(n.length/r/100),e.bindBuffer(e.ARRAY_BUFFER,o),e.bufferData(e.ARRAY_BUFFER,i*r*4,a),e.bufferSubData(e.ARRAY_BUFFER,0,n)},add:function(t){var f=n.length,c=100*Math.floor(n.length/r/100);c>=i&&(i=c+100,e.bindBuffer(e.ARRAY_BUFFER,o),e.bufferData(e.ARRAY_BUFFER,i*r*4,a),e.bufferSubData(e.ARRAY_BUFFER,0,n));var l=new u(f+r);l.set(n),n=l,this.item(f/r,t)},item:function(t,a){var i=new u(a);n.set(i,t*r),e.bindBuffer(e.ARRAY_BUFFER,o),e.bufferSubData(e.ARRAY_BUFFER,t*r*4,i)},getItem:function(e){return Array.from(n.slice(e*r,(e+1)*r))}};return f.set(t),f},o=function(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Uint8Array,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.STATIC_DRAW,a=e.createBuffer(),o=0,i=3,f={buffer:a,get data(){return r},get length(){return r.length},set:function(t){r=new n(t),o=100*Math.ceil(r.length/i/100),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,a),e.bufferData(e.ELEMENT_ARRAY_BUFFER,o*i*4,u),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,r)},add:function(t){var f=r.length,c=100*Math.floor(r.length/i/100);c>=o&&(o=c+100,e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,a),e.bufferData(e.ELEMENT_ARRAY_BUFFER,o*i*4,u),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,r));var l=new n(f+i);l.set(r),r=l,this.item(f/i,t)},item:function(t,u){var o=new n(u);r.set(o,t*i),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,a),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,t*i*4,o)},getItem:function(e){return Array.from(r.slice(e*i,(e+1)*i))}};return f.set(t),f},i=function(e){var t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),t},f=function(e,t){var r=i(e),n=new Image;return n.onload=function(){r.width=n.width,r.height=n.height,e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.bindTexture(e.TEXTURE_2D,null)},n.src=t,r},c=function(e,t,r,n){e.bindFramebuffer(e.FRAMEBUFFER,t),void 0!==r&&void 0!==n&&e.viewport(0,0,r,n)},l=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t?r?c(e,t.framebuffer,t.width,t.height):c(e,t.framebuffer):r?c(e,null,e.canvas.width,e.canvas.height):c(e,null)},v=function(e,t,r){var n={width:t||e.canvas.clientWidth,height:r||e.canvas.clientHeight},u=i(e);n.texture=u,e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,null);var a=e.createFramebuffer();return n.framebuffer=a,e.bindFramebuffer(e.FRAMEBUFFER,a),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,u,0),e.bindFramebuffer(e.FRAMEBUFFER,null),n},s={attribFloat:function(e,t,r,n){var u=e.getAttribLocation(t,r);return e.enableVertexAttribArray(u),function(t){e.bindBuffer(e.ARRAY_BUFFER,t),e.vertexAttribPointer(u,n,e.FLOAT,!1,0,0)}}},d={uniform1f:function(e,t,r){var n=e.getUniformLocation(t,r);return function(t){e.uniform1f(n,t)}},uniform2fv:function(e,t,r){var n=e.getUniformLocation(t,r);return function(t){e.uniform2fv(n,t)}},uniform3fv:function(e,t,r){var n=e.getUniformLocation(t,r);return function(t){e.uniform3fv(n,t)}},uniformTexture:function(e,t,r,n){var u=e.getUniformLocation(t,r);return function(t){e.activeTexture(e.TEXTURE0+n),e.bindTexture(e.TEXTURE_2D,t),e.uniform1i(u,n)}},uniform1i:function(e,t,r){var n=e.getUniformLocation(t,r);return function(t){e.uniform1i(n,t)}},uniformMatrix4fv:function(e,t,r){var n=e.getUniformLocation(t,r);return function(t){e.uniformMatrix4fv(n,!1,t)}}},b=function(e,t,r,n,u){var a=t(e,r,n);return{programInfo:a,use:function(){e.useProgram(a.program)},attribSet:function(e){for(var t in e)a.attribLocations[t]&&a.attribLocations[t](e[t])},uniformSet:function(e){for(var t in e)a.uniformLocations[t]&&a.uniformLocations[t](e[t])},elementSet:function(t){e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t)}}},m=function(e){return[[e[0],e[1]],[e[2],e[1]],[e[2],e[3]],[e[0],e[3]]].flat()},E=function(e){e.clearColor(0,0,0,1),e.clear(e.COLOR_BUFFER_BIT)},p=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];l(e,t,n),r&&E(e)}},1:function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return c}));var n=r(3),u=r.n(n),a=r(4),o=r.n(a),i=r(2),f=function(){function e(){u()(this,e)}return o()(e,null,[{key:"normalize",value:function(t){return e.length(t)?e.scale(t,1/e.length(t)):t}},{key:"rotate",value:function(e,t){var r=Math.cos(t),n=Math.sin(t);return[e[0]*r-e[1]*n,e[1]*r+e[0]*n]}},{key:"dot",value:function(e,t){return e[0]*t[0]+e[1]*t[1]}},{key:"cross",value:function(e,t){return e[0]*t[1]-e[1]*t[0]}},{key:"add",value:function(e,t){return[e[0]+t[0],e[1]+t[1]]}},{key:"sub",value:function(e,t){return[e[0]-t[0],e[1]-t[1]]}},{key:"projection",value:function(t,r){var n=e.dot(t,r)/e.dot(r,r);return[r[0]*n,r[1]*n]}},{key:"length",value:function(t){return Math.sqrt(e.dot(t,t))}},{key:"mul",value:function(e,t){return[e[0]*t[0],e[1]*t[1]]}},{key:"div",value:function(e,t){return[e[0]/t[0],e[1]/t[1]]}},{key:"scale",value:function(e,t){return[e[0]*t,e[1]*t]}},{key:"collisionCalc",value:function(t,r,n,u){return e.scale(e.add(e.scale(t,n-u),e.scale(r,2*u)),1/(n+u))}},{key:"getAngle",value:function(e){return Math.atan2(e[1],e[0])}},{key:"floor",value:function(e){return[Math.floor(e[0]),Math.floor(e[1])]}},{key:"fract",value:function(e){return[i.a.fract(e[0]),i.a.fract(e[1])]}},{key:"sin",value:function(e){return[Math.sin(e[0]),Math.sin(e[1])]}},{key:"cos",value:function(e){return[Math.cos(e[0]),Math.cos(e[1])]}},{key:"distance",value:function(t,r){return e.length(e.sub(r,t))}},{key:"mix",value:function(e,t,r){return[i.a.mix(e[0],t[0],r),i.a.mix(e[1],t[1],r)]}},{key:"abs",value:function(e){return[Math.abs(e[0]),Math.abs(e[1])]}},{key:"getLine",value:function(t,r){return{pos:t,dir:e.sub(r,t)}}}]),e}(),c=function(){function e(){u()(this,e)}return o()(e,null,[{key:"set",value:function(e,t,r){return e[0]=t,e[1]=r,e}},{key:"normalize",value:function(t){var r=f.length(t);return r&&e.scale(t,1/r),t}},{key:"add",value:function(e,t){return e[0]+=t[0],e[1]+=t[1],e}},{key:"sub",value:function(e,t){return e[0]-=t[0],e[1]-=t[1],e}},{key:"scale",value:function(e,t){return e[0]*=t,e[1]*=t,e}},{key:"rotate",value:function(e,t){var r=Math.cos(t),n=Math.sin(t),u=[e[0]*r-e[1]*n,e[1]*r+e[0]*n];return e[0]=u[0],e[1]=u[1],e}}]),e}()},2:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(3),u=r.n(n),a=r(4),o=r.n(a),i=function(){function e(){u()(this,e)}return o()(e,null,[{key:"mix",value:function(e,t,r){return e*(1-r)+t*r}},{key:"fract",value:function(e){return(e%=1)<0?e+1:e}},{key:"inverseMix",value:function(e,t,r){return(r-e)/(t-e)}},{key:"clamp",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e<=t?t:e>=r?r:e}},{key:"smoothstep",value:function(e,t,r){return(r=clamp(inverseMix(e,t,r)))*r*(3-2*r)}}]),e}()},3:function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},4:function(e,t){function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}},48:function(e,t){e.exports="precision mediump float;\r\nvarying vec2 vTextureCoord;\r\nuniform lowp vec2 uSize;\r\nuniform float uTime;\r\nuniform vec2 uStartPos;\r\nuniform vec2 uControlPos;\r\nuniform vec2 uEndPos;\r\nconst float pi=3.14159265359;\r\n\r\nfloat distLine(vec2 p,vec2 a,vec2 b,float w){\r\n  vec2 pa=p-a;\r\n  vec2 ba=b-a;\r\n  float t=clamp(dot(pa,ba)/dot(ba,ba),0.,1.);\r\n  return length(pa-ba*t)/w;\r\n}\r\nfloat ball(vec2 f,float r){\r\n  return smoothstep(1.,.99,length(f)/r);\r\n}\r\nfloat cross(vec2 v0,vec2 v1){\r\n  return v0.x*v1.y-v0.y*v1.x;\r\n}\r\nvec2 getQuadraticCurveTo(vec2 p0,vec2 p1,vec2 p2,float t){\r\n  return p0*(1.-t)*(1.-t)+p1*2.*(1.-t)*t+p2*t*t;\r\n}\r\nvec2 getQuadraticCurveToTangent(vec2 p0,vec2 p1,vec2 p2,float t){\r\n  return 2.*t*(p0-p1*2.+p2)+2.*(-p0+p1);\r\n}\r\n/*float distLine0(vec2 p,vec2 a,vec2 b){\r\n  vec2 pa=p-a;\r\n  vec2 ba=b-a;\r\n  float t=clamp(dot(pa,ba)/dot(ba,ba),0.,1.);\r\n  return length(pa-ba*t);\r\n}*/\r\nvec2 quadraticCurve(vec2 p,vec2 a,vec2 b,vec2 c,float w){\r\n  float s=.5;\r\n  float rate=.5;\r\n  const int N=8;\r\n  vec2 p0=getQuadraticCurveTo(a,b,c,0.);\r\n  vec2 p2=getQuadraticCurveTo(a,b,c,1.);\r\n  vec2 p1=getQuadraticCurveTo(a,b,c,rate);\r\n  for(int i=0;i<N;i++){\r\n    /*float line0 = distLine(p,p1,p0,1.);\r\n    float line1 = distLine(p,p1,p2,1.);\r\n    if(line0<line1){\r\n      rate-=s*.5;\r\n      p2 = p1;\r\n    }else if(line0>line1){\r\n      rate+=s*.5;\r\n      p0 = p1;\r\n    }else{*/\r\n      vec2 t=getQuadraticCurveToTangent(a,b,c,rate);\r\n      t=vec2(-t.y,t.x);\r\n      if(cross(p-p1,t)<0.){\r\n        rate-=s*.5;\r\n        p2=p1;\r\n      }else{\r\n        rate+=s*.5;\r\n        p0=p1;\r\n      }\r\n    //}\r\n    s*=.5;\r\n    p1=getQuadraticCurveTo(a,b,c,rate);\r\n  }\r\n  //return vec2(length(p-p1)/w,rate);\r\n  return vec2(distLine(p,p0,p2,w),rate);\r\n}\r\nvoid main()\r\n{\r\n  \r\n  vec4 color=vec4(0.);\r\n  vec2 uv=vTextureCoord*uSize;\r\n  \r\n  vec2 uv0=quadraticCurve(uv,uStartPos,uControlPos,uEndPos,5.);\r\n  color+=uv0.y;\r\n  color=mix(color,vec4(1.,0.,0.,1.),smoothstep(1.,0.,uv0.x));\r\n  \r\n  vec2 p=getQuadraticCurveTo(uStartPos,uControlPos,uEndPos,fract(uTime*.1));\r\n  color+=ball(uv-p,5.);\r\n  \r\n  vec2 t=getQuadraticCurveToTangent(uStartPos,uControlPos,uEndPos,fract(uTime*.1));\r\n  t=vec2(-t.y,t.x);\r\n  color+=smoothstep(1.,0.,distLine(uv,p,p+10.*normalize(t),1.));\r\n  \r\n  gl_FragColor=color;\r\n}\r\n\r\n"},5:function(e,t){e.exports="attribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\nvarying highp vec2 vTextureCoord;\r\nuniform float uFlipY;\r\nvoid main(void){\r\n  vTextureCoord=aTextureCoord;\r\n  gl_Position=vec4((2.*aVertexPosition+vec2(-1.,-1.))*vec2(1.,uFlipY),0.,1.);\r\n}"},71:function(e,t,r){"use strict";r.r(t);var n=r(0),u=r(1),a=r(5),o=r.n(a),i=r(48),f=r.n(i),c=function(e,t,r){var u=Object(n.f)(e,t,r);return{program:u,attribLocations:{vertexPosition:n.b.attribFloat(e,u,"aVertexPosition",2),textureCoord:n.b.attribFloat(e,u,"aTextureCoord",2)},uniformLocations:{flipY:n.i.uniform1f(e,u,"uFlipY"),size:n.i.uniform2fv(e,u,"uSize"),time:n.i.uniform1f(e,u,"uTime"),startPos:n.i.uniform2fv(e,u,"uStartPos"),controlPos:n.i.uniform2fv(e,u,"uControlPos"),endPos:n.i.uniform2fv(e,u,"uEndPos")}}},l=function(e){return Object.assign(Object(n.h)(e,c,o.a,f.a),{draw:function(t){e.drawElements(e.TRIANGLES,t,e.UNSIGNED_BYTE,0)}})};function v(e){var t=[[0,0],[1,0],[1,1],[0,1]].flat(),r=Object(n.a)(e,t,2),u=[[0,0],[1,0],[1,1],[0,1]].flat(),a=Object(n.a)(e,u,2),o=[[0,1,3],[1,2,3]].flat();return{positionBufferData:r,textureCoordinatesBufferData:a,indicesBufferData:Object(n.d)(e,o)}}!function(){var e=document.querySelector("#glcanvas"),t=e.getContext("webgl",{alpha:!1});if(!t)return void alert("無法初始化WebGL。您的瀏覽器或機器可能不支持它。");var r={quadraticCurveShader:l(t)},a={face:v(t),view:v(t)},o=[.5*t.canvas.width,.5*t.canvas.height];e.addEventListener("mousemove",(function(e){u.b.set(o,e.pageX,e.pageY)}));var i=[t.canvas.clientWidth,t.canvas.clientHeight],f={};var c=0;requestAnimationFrame((function e(u){var l=.001*(u-c);c=u,requestAnimationFrame(e),function(e,t,r,u,a){var o=a.now,i=(a.framebufferTextures,a.mPos,a.size),f=r.face,c=t.quadraticCurveShader;c.use(),c.attribSet({vertexPosition:f.positionBufferData.buffer,textureCoord:f.textureCoordinatesBufferData.buffer}),c.uniformSet({size:i,time:.001*o,flipY:-1,startPos:[300,400],controlPos:[400,300],endPos:[500,400]}),Object(n.j)(e),c.draw(f.indicesBufferData.length)}(t,r,a,0,{now:u,delta:l,mPos:o,framebufferTextures:f,size:i})}))}()}});