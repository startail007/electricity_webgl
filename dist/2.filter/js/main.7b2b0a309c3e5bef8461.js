!function(r){var e={};function t(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return r[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=r,t.c=e,t.d=function(r,e,n){t.o(r,e)||Object.defineProperty(r,e,{enumerable:!0,get:n})},t.r=function(r){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},t.t=function(r,e){if(1&e&&(r=t(r)),8&e)return r;if(4&e&&"object"==typeof r&&r&&r.__esModule)return r;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:r}),2&e&&"string"!=typeof r)for(var o in r)t.d(n,o,function(e){return r[e]}.bind(null,o));return n},t.n=function(r){var e=r&&r.__esModule?function(){return r.default}:function(){return r};return t.d(e,"a",e),e},t.o=function(r,e){return Object.prototype.hasOwnProperty.call(r,e)},t.p="",t(t.s=42)}({32:function(r,e){r.exports="attribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\nvarying highp vec2 vTextureCoord;\r\nvarying highp vec2 vertPos;\r\nuniform float uFlipY;\r\nvoid main(void){\r\n  vTextureCoord=aTextureCoord;\r\n  vertPos=aVertexPosition;\r\n  gl_Position=vec4((2.*aVertexPosition+vec2(-1.,-1.))*vec2(1.,uFlipY),0.,1.);\r\n}"},33:function(r,e){r.exports="precision mediump float;\r\nvarying highp vec2 vTextureCoord;\r\nuniform sampler2D uSampler;\r\nvarying vec2 vertPos;\r\nuniform lowp vec2 uMouse;\r\nuniform lowp vec2 uSize;\r\nuniform float uFilter[9];\r\n\r\nvoid main(void){\r\n  vec2 pos=vertPos*uSize;\r\n  vec2 distVec=pos-uMouse;\r\n  float distance=length(distVec);\r\n  if(distance>160.){\r\n    gl_FragColor=texture2D(uSampler,vTextureCoord);\r\n  }else if(distance>159.){\r\n    gl_FragColor=vec4(1.,0.,0.,1.);\r\n  }else{\r\n    vec2 offsBlur=vec2(1.,1.)/uSize;\r\n    vec4 colorSum=vec4(0.);\r\n    for(int j=-1;j<=1;j++){\r\n      for(int i=-1;i<=1;i++){\r\n        colorSum+=texture2D(uSampler,vTextureCoord+offsBlur*vec2(i,j))*uFilter[(j+1)*3+(i+1)];\r\n      }\r\n    }\r\n    gl_FragColor=vec4(colorSum.rgb,1.);\r\n  }\r\n}\r\n\r\n/*precision mediump float;\r\nvarying highp vec2 vTextureCoord;\r\nuniform sampler2D uSampler;\r\nvarying vec2 vertPos;\r\nuniform vec2 uMouse;\r\nuniform vec2 uSize;\r\nuniform float uFilter[9];\r\nuniform float uFilterWeight;\r\n\r\nfloat CalcGauss(float x,float sigma)\r\n{\r\n  float coeff=1./(2.*3.14157*sigma);\r\n  float expon=-(x*x)/(2.*sigma);\r\n  return(coeff*exp(expon));\r\n}\r\n\r\nvoid main()\r\n{\r\n  vec4 texCol=texture2D(uSampler,vTextureCoord);\r\n  vec4 gaussCol=vec4(texCol.rgb,1.);\r\n  vec2 step=1./uSize;\r\n  const int u_width=2;\r\n  float u_sigma=1.;\r\n  for(int j=-u_width;j<=u_width;j++)\r\n  {\r\n    for(int i=-u_width;i<=u_width;i++)\r\n    {\r\n      vec2 actStep=vec2(float(i)*step.x,float(j)*step.y);\r\n      float weight=CalcGauss(float(i)/float(u_width),u_sigma);\r\n      texCol=texture2D(uSampler,vTextureCoord+actStep);\r\n      gaussCol+=vec4(texCol.rgb*weight,weight);\r\n      texCol=texture2D(uSampler,vTextureCoord-actStep);\r\n      gaussCol+=vec4(texCol.rgb*weight,weight);\r\n    }\r\n  }\r\n  gaussCol.rgb/=gaussCol.w;\r\n  gl_FragColor=vec4(gaussCol.rgb,1.);\r\n}*/"},42:function(r,e,t){"use strict";t.r(e);var n=t.p+"img/image.7826b8fad510e7131700fc463cce2c7c.jpg";function o(r,e,t){var n,o=function(r,e,t){var n=f(r,r.VERTEX_SHADER,e),o=f(r,r.FRAGMENT_SHADER,t),i=r.createProgram();if(r.attachShader(i,n),r.attachShader(i,o),r.linkProgram(i),!r.getProgramParameter(i,r.LINK_STATUS))return alert("無法初始化著色器程序: "+r.getProgramInfoLog(i)),null;return i}(r,e,t);return{program:o,attribLocations:{vertexPosition:(n=r.getAttribLocation(o,"aVertexPosition"),function(e){r.bindBuffer(r.ARRAY_BUFFER,e),r.vertexAttribPointer(n,2,r.FLOAT,!1,0,0),r.enableVertexAttribArray(n)}),textureCoord:function(){var e=r.getAttribLocation(o,"aTextureCoord");return function(t){r.bindBuffer(r.ARRAY_BUFFER,t),r.vertexAttribPointer(e,2,r.FLOAT,!1,0,0),r.enableVertexAttribArray(e)}}()},uniformLocations:{flipY:function(){var e=r.getUniformLocation(o,"uFlipY");return function(t){r.uniform1f(e,t)}}(),sampler:function(){var e=r.getUniformLocation(o,"uSampler");return function(t,n){r.activeTexture(r.TEXTURE0+n),r.bindTexture(r.TEXTURE_2D,t),r.uniform1i(e,n)}}(),size:function(){var e=r.getUniformLocation(o,"uSize");return function(t){r.uniform2fv(e,t)}}(),mouse:function(){var e=r.getUniformLocation(o,"uMouse");return function(t){r.uniform2fv(e,t)}}(),filter:function(){var e=r.getUniformLocation(o,"uFilter[0]");return function(t){r.uniform1fv(e,t)}}()}}}function i(r){var e=r.createTexture();return r.bindTexture(r.TEXTURE_2D,e),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),e}function a(r,e,t,n){r.bindFramebuffer(r.FRAMEBUFFER,e),r.viewport(0,0,t,n)}function u(r,e){var t=i(r),n=new Image;return n.onload=function(){r.bindTexture(r.TEXTURE_2D,t),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,n)},n.src=e,t}function f(r,e,t){var n=r.createShader(e);return r.shaderSource(n,t),r.compileShader(n),r.getShaderParameter(n,r.COMPILE_STATUS)?n:(alert("編譯著色器時發生錯誤: "+r.getShaderInfoLog(n)),r.deleteShader(n),null)}!function(){var r=document.querySelector("#glcanvas"),e=r.getContext("webgl");if(!e)return void alert("無法初始化WebGL。您的瀏覽器或機器可能不支持它。");var f={filterShader:o(e,t(32),t(33))},c=function(r){var e=[[0,0],[1,0],[1,1],[0,1]].flat(),t=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,t),r.bufferData(r.ARRAY_BUFFER,new Float32Array(e),r.STATIC_DRAW);var n=[[0,0],[1,0],[1,1],[0,1]].flat(),o=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,o),r.bufferData(r.ARRAY_BUFFER,new Float32Array(n),r.STATIC_DRAW);var i=[[0,1,3],[1,2,3]].flat(),a=r.createBuffer();return r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,a),r.bufferData(r.ELEMENT_ARRAY_BUFFER,new Uint8Array(i),r.STATIC_DRAW),{position:t,textureCoord:o,indexLength:i.length}}(e),l=[u(e,n)],s=[0,0];r.addEventListener("mousemove",(function(r){s[0]=r.pageX,s[1]=r.pageY}));for(var v=[],m=0;m<2;m++){var d={},T=i(e);d.texture=T,e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.canvas.clientWidth,e.canvas.clientHeight,0,e.RGBA,e.UNSIGNED_BYTE,null);var E=e.createFramebuffer();d.framebuffer=E,e.bindFramebuffer(e.FRAMEBUFFER,E),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,T,0),v.push(d)}e.bindFramebuffer(e.FRAMEBUFFER,null),requestAnimationFrame((function r(t){requestAnimationFrame(r),function(r,e,t,n,o,i){r.clearColor(0,0,0,1),r.clearDepth(1),r.enable(r.DEPTH_TEST),r.depthFunc(r.LEQUAL),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT);var u=e.filterShader;r.useProgram(u.program),u.attribLocations.vertexPosition(t.position),u.attribLocations.textureCoord(t.textureCoord),u.uniformLocations.flipY(1),u.uniformLocations.sampler(n[0],0),u.uniformLocations.size([r.canvas.clientWidth,r.canvas.clientHeight]),u.uniformLocations.mouse(o);var f=0,c=i[f%2];a(r,c.framebuffer,r.canvas.width,r.canvas.height);var l=[[-2,-1,0],[-1,1,1],[0,1,2]].flat(),s=l.reduce((function(r,e){return r+e}),0);u.uniformLocations.filter(l.map((function(r){return r/s}))),r.drawElements(r.TRIANGLE_STRIP,t.indexLength,r.UNSIGNED_BYTE,0),u.uniformLocations.sampler(c.texture,0),f++;var v=i[f%2];a(r,v.framebuffer,r.canvas.width,r.canvas.height);var m=[[.111,.111,.111],[.111,.111,.111],[.111,.111,.111]].flat(),d=m.reduce((function(r,e){return r+e}),0);u.uniformLocations.filter(m.map((function(r){return r/d}))),r.drawElements(r.TRIANGLE_STRIP,t.indexLength,r.UNSIGNED_BYTE,0),u.uniformLocations.sampler(v.texture,0),f++,a(r,null,r.canvas.width,r.canvas.height),u.uniformLocations.flipY(-1),r.drawElements(r.TRIANGLE_STRIP,t.indexLength,r.UNSIGNED_BYTE,0)}(e,f,c,l,s,v)}))}()}});